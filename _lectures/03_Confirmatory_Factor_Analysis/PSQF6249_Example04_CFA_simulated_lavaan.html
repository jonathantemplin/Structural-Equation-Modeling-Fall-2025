<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PSQF 6249 Example 03</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EPSY906_Example04_CFA_simulated_lavaan_files/libs/clipboard/clipboard.min.js"></script>
<script src="EPSY906_Example04_CFA_simulated_lavaan_files/libs/quarto-html/quarto.js"></script>
<script src="EPSY906_Example04_CFA_simulated_lavaan_files/libs/quarto-html/popper.min.js"></script>
<script src="EPSY906_Example04_CFA_simulated_lavaan_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EPSY906_Example04_CFA_simulated_lavaan_files/libs/quarto-html/anchor.min.js"></script>
<link href="EPSY906_Example04_CFA_simulated_lavaan_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EPSY906_Example04_CFA_simulated_lavaan_files/libs/quarto-html/quarto-syntax-highlighting-f23ab18612d661d7bd56dbc0c0fd3817.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EPSY906_Example04_CFA_simulated_lavaan_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EPSY906_Example04_CFA_simulated_lavaan_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EPSY906_Example04_CFA_simulated_lavaan_files/libs/bootstrap/bootstrap-e19dc0c07aeef78048e587c3f1edba7a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="EPSY906_Example04_CFA_simulated_lavaan_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="EPSY906_Example04_CFA_simulated_lavaan_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PSQF 6249 Example 03</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
      equationNumbers: { 
            autoNumber: "all",
            formatNumber: function (n) {return n}
      } 
  }
});
</script>
<section id="cfa-example-using-simulated-forgiveness-of-situations-n-1103" class="level2">
<h2 class="anchored" data-anchor-id="cfa-example-using-simulated-forgiveness-of-situations-n-1103">CFA Example Using <em>Simulated</em> Forgiveness of Situations (N = 1103)</h2>
<p>The Forgiveness of Situations Subscale includes six items, three of which are reverse-coded, on a seven-point scale:</p>
<ol type="1">
<li>When things go wrong for reasons that can’t be controlled, I get stuck in negative thoughts about it. (R)</li>
<li>With time I can be understanding of bad circumstances in my life.</li>
<li>If I am disappointed by uncontrollable circumstances in my life, I continue to think negatively about them. (R)</li>
<li>I eventually make peace with bad situations in my life.</li>
<li>It’s really hard for me to accept negative situations that aren’t anybody’s fault. (R)</li>
<li>Eventually I let go of negative thoughts about bad circumstances that are beyond anyone’s control.</li>
</ol>
<p>Response Anchors:</p>
<ul>
<li>1 = Almost Always False of Me</li>
<li>2 = ?</li>
<li>3 = More Often False of Me</li>
<li>4 = ?</li>
<li>5 = More Often True of Me</li>
<li>6 = ?</li>
<li>7 = Almost Always True of Me</li>
</ul>
<p><em>Note: the data for this example are simulated based on the results of the real data analysis. These results will be different than those reported in the other example file but are used to show you how to execute the syntax in this analysis.</em></p>
<section id="package-installation-and-loading" class="level3">
<h3 class="anchored" data-anchor-id="package-installation-and-loading">Package Installation and Loading</h3>
<p>For this example, we will be using the <code>ggplot2</code> (for general plotting), <code>melt2</code> (for data reshaping before plotting), and <code>lavaan</code> (for CFA) packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(ggplot2)<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(reshape2) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"reshape2"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: reshape2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(lavaan) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"lavaan"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lavaan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(psych) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"psych"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: psych</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lavaan':

    cor2cov</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(knitr) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"knitr"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: knitr</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(kableExtra) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: kableExtra</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(semPlot) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"semPlot"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: semPlot</code></pre>
</div>
</div>
</section>
<section id="data-import-into-r" class="level3">
<h3 class="anchored" data-anchor-id="data-import-into-r">Data Import into R</h3>
<p>The data are in a text file named <code>Study2.dat</code> originally used in Mplus (so no column names were included at the top of the file). The file contains more items than we will use, so we select only the “Forgiveness of Situations” items from the whole file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#syntax from previous example: commented to remove for simulation</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #read in data file (Mplus file format so having to label columns)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># hfsData = read.table(file = "Study2.dat", header = FALSE, na.strings = "99999", col.names = c("PersonID", "Self1", "Self2r", "Self3", "Self4r", "Self5", "Self6r", "Other1r", "Other2", "Other3r", "Other4", "Other5r", "Other6", "Sit1r", "Sit2", "Sit3r", "Sit4", "Sit5r", "Sit6", "Selfsub", "Othsub", "Sitsub", "HFSsum"))</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># #select Situations items and PersonID variables</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># hfsSituations = hfsData[c("PersonID", "Sit1r", "Sit2", "Sit3r", "Sit4", "Sit5r", "Sit6")]</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#setting seed for output constancy across machines</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">04092017</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simulating data for analysis based on results of model04estimates</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>model04Simulate <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st"># SitP loadings (all estimated)</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="st">SitP =~ 1.007*Sit2 + 1.064*Sit4 + 0.956*Sit6</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="st"># SitN loadings (all estimated)</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="st">SitN =~ 1.325*Sit1r + 1.349*Sit3r + 1.009*Sit5r</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="st"># Unique Variances:</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ 1.294*Sit1r; Sit2 ~~ 0.888*Sit2; Sit3r ~~ 0.724*Sit3r; Sit4 ~~ 0.835*Sit4; Sit5r ~~ 1.926*Sit5r; Sit6 ~~ 1.428*Sit6; </span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="st"># Item Intercepts:</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="st">Sit2 ~ 5.289*1</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="st">Sit4 ~ 5.359*1</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="st">Sit6 ~ 5.321*1</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~ 4.547*1</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="st">Sit3r ~ 4.896*1</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="st">Sit5r ~ 4.860*1</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="st"># Factor Covariances</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="st">SitP ~~ .564*SitN</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="co">#generate data</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>hfsSituations <span class="ot">=</span> <span class="fu">simulateData</span>(<span class="at">model =</span> model04Simulate, <span class="at">sample.nobs =</span> <span class="dv">1103</span>L, <span class="at">model.type =</span> <span class="st">"sem"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="co">#add ID variable</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>hfsSituations <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">PersonID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1103</span>, hfsSituations)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co">#reorder variables to match data file</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>hfsSituations <span class="ot">=</span> hfsSituations[<span class="fu">c</span>(<span class="st">"PersonID"</span>, <span class="st">"Sit1r"</span>, <span class="st">"Sit2"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit5r"</span>, <span class="st">"Sit6"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="observed-sample-statistics" class="level3">
<h3 class="anchored" data-anchor-id="observed-sample-statistics">Observed Sample Statistics</h3>
<section id="sample-correlation-matrix" class="level4">
<h4 class="anchored" data-anchor-id="sample-correlation-matrix">Sample Correlation Matrix</h4>
<p>The observed correlation matrix, rounded to three digits:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#here the c() function selects only the variables, not the PersionID variable</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(hfsSituations[<span class="fu">c</span>(<span class="st">"Sit1r"</span>, <span class="st">"Sit2"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit5r"</span>, <span class="st">"Sit6"</span>)]), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Sit1r  Sit2 Sit3r  Sit4 Sit5r  Sit6
Sit1r 1.000 0.360 0.658 0.348 0.450 0.284
Sit2  0.360 1.000 0.412 0.588 0.257 0.464
Sit3r 0.658 0.412 1.000 0.400 0.497 0.315
Sit4  0.348 0.588 0.400 1.000 0.277 0.440
Sit5r 0.450 0.257 0.497 0.277 1.000 0.193
Sit6  0.284 0.464 0.315 0.440 0.193 1.000</code></pre>
</div>
</div>
</section>
<section id="sample-means-and-variances" class="level4">
<h4 class="anchored" data-anchor-id="sample-means-and-variances">Sample Means and Variances</h4>
<p>The observed means, rounded to three digits:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit1r"</span>, <span class="st">"Sit2"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit5r"</span>, <span class="st">"Sit6"</span>)], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">mean</span>(x), <span class="at">digits =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sit1r  Sit2 Sit3r  Sit4 Sit5r  Sit6 
4.443 5.287 4.778 5.314 4.761 5.263 </code></pre>
</div>
</div>
<p>The observed variances (using <span class="math inline">\(N\)</span> in the denominator to match ML estimated output and Mplus example), rounded to three digits:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit1r"</span>, <span class="st">"Sit2"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit5r"</span>, <span class="st">"Sit6"</span>)], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">var</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">1102</span><span class="sc">/</span><span class="dv">1103</span>, <span class="at">digits =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sit1r  Sit2 Sit3r  Sit4 Sit5r  Sit6 
3.209 2.007 2.616 1.976 2.979 2.281 </code></pre>
</div>
</div>
</section>
<section id="sample-covariances" class="level4">
<h4 class="anchored" data-anchor-id="sample-covariances">Sample Covariances</h4>
<p>To do a CFA analysis, you only really need means, variances, and either correlations or covariances among items. That said, modern methods of estimation use the raw data (often called full information) rather than the summary statistics as the raw data enable better missing data assumptions when using maximum likelihood and Bayesian estimation methods.</p>
<p>The sample covariance matrix can be found from the sample correlations and variances. Each covariance between a pair of variables <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span> is denoted with a <span class="math inline">\(\sigma_{y_1, y_2}\)</span> and each correlation is denoted with a <span class="math inline">\(\rho_{y_1, y_2}\)</span>. The variance of a variable is denoted by <span class="math inline">\(\sigma^2_{y_1}\)</span> and the standard deviation of a variable is the square root of the variance <span class="math inline">\(\sqrt{\sigma^2_{y_1}}\)</span>. The covariance can be found by taking the correlation and multiplying it by the product of the standard deviations.</p>
<p><span class="math display">\[\sigma_{y_1, y_2} = \rho_{y_1, y_2}\sqrt{\sigma^2_{y_1}}\sqrt{\sigma^2_{y_2}}. \]</span></p>
<p>Inversely, the correlation can be found by taking the covariance and dividing it by the product of the standard deviations:</p>
<p><span class="math display">\[\rho_{y_1, y_2} = \frac{\sigma_{y_1, y_2}}{\sqrt{\sigma^2_{y_1}}\sqrt{\sigma^2_{y_2}}}. \]</span> Again, we change the denominator from <span class="math inline">\(N-1\)</span> to <span class="math inline">\(N\)</span> to be consistent with the Mplus example, which calculates covariances using maximum likelihood.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cov</span>(hfsSituations[<span class="fu">c</span>(<span class="st">"Sit1r"</span>, <span class="st">"Sit2"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit5r"</span>, <span class="st">"Sit6"</span>)])<span class="sc">*</span><span class="dv">1102</span><span class="sc">/</span><span class="dv">1103</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Sit1r  Sit2 Sit3r  Sit4 Sit5r  Sit6
Sit1r 3.209 0.914 1.905 0.876 1.391 0.768
Sit2  0.914 2.007 0.945 1.170 0.629 0.994
Sit3r 1.905 0.945 2.616 0.909 1.386 0.769
Sit4  0.876 1.170 0.909 1.976 0.673 0.934
Sit5r 1.391 0.629 1.386 0.673 2.979 0.502
Sit6  0.768 0.994 0.769 0.934 0.502 2.281</code></pre>
</div>
</div>
</section>
<section id="sample-item-response-distributions" class="level4">
<h4 class="anchored" data-anchor-id="sample-item-response-distributions">Sample Item Response Distributions</h4>
<p>The assumptions of CFA (i.e., normally distributed factors, no item-level factor interactions, and conditionally normal distributed items) lead to the overall assumption that our item responses must be normally distributed. From the histograms below, do you think these are normally distributed?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stack data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>melted <span class="ot">=</span> <span class="fu">melt</span>(hfsSituations, <span class="at">id.vars =</span> <span class="st">"PersonID"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot by variable</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted, <span class="fu">aes</span>(value)) <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/histograms-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="lavaan-syntax" class="level3">
<h3 class="anchored" data-anchor-id="lavaan-syntax">Lavaan Syntax</h3>
<p>lavaan syntax is constructed using a long text string and saved in a character object. In the example below <code>model01SyntaxLong = "</code> opens the text string, which continues for multiple lines until the final <code>"</code> terminates the string. The variable model01Syntax now contains the text of the <code>lavaan</code> syntax. Within the syntax string, the R comment character <code>#</code> still functions to comment text around the syntax. Each part of the model syntax corresponds to a set of parameters in the CFA model. You can find information about lavaan at <a href="https://lavaan.ugent.be">https://lavaan.ugent.be</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>model01SyntaxLong <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="st"># Model 1 --  Fully Z-Scored Factor Identification Approach</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="st"># Item factor loadings --&gt; list the factor to the left of the =~ and the items to the right, separated by a plus</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="st"># Once the factor is defined it can be used in syntax as if it is an observed variable</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="st"># Parameters can be fixed to constant values by using the * command; starting values can be specified by using start()*; labels can be implemented with []</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="st">Sit =~ Sit1r + Sit2 + Sit3r + Sit4 + Sit5r + Sit6</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="st"># Item intercepts --&gt; ~ 1 indicates means or intercepts</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="st"># You can put multiple lines of syntax on a single line using a ; </span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~ 1; Sit2 ~ 1; Sit3r  ~ 1; Sit4 ~ 1; Sit5r ~ 1; Sit6 ~ 1;</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="st"># Item error (unique) variances and covariances --&gt; use the ~~ command</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ Sit1r; Sit2 ~~ Sit2; Sit3r ~~ Sit3r; Sit4 ~~ Sit4; Sit5r ~~ Sit5r; Sit6 ~~ Sit6; </span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="st"># Factor variance</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="st">Sit ~~ 100*Sit</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="st"># Factor mean (intercept)</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="st">Sit ~ 0</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To run lavaan, the syntax string variable is passed to the <code>lavaan(model = model01SyntaxLong, ...)</code> function. In the function call, we also supply:</p>
<ul>
<li><code>data = hfsSituations</code>: The data frame which contains the variables in the syntax.</li>
<li><code>estimator = "MLR"</code>: Enables the use of robust maximum likelihood estimation, which helps for data that are not entirely normal.</li>
<li><code>mimic = "mplus"</code>: Ensures compatibility with Mplus output, which is often needed in practice (and is certainly needed for our homework system).</li>
<li><code>std.lv = TRUE</code>: Uses the Z-score method of identification, setting all latent variable means to zero, all latent variable variances to one, and estimating all factor loadings.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model01Estimates <span class="ot">=</span> <span class="fu">lavaan</span>(<span class="at">model =</span> model01SyntaxLong, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>, <span class="at">std.lv =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the model estimation was successful, no errors would be displayed (and no output would be shown). All model information and results are contained within the <code>model01Estimates</code> object. To access a summary of the results use the <code>summary()</code> function with the following arguments:</p>
<ul>
<li><code>model01Estimates</code>: The analysis to be summarized.</li>
<li><code>fit.measures=TRUE</code>: Provides model fit indices in summary.</li>
<li><code>rsqaure=TRUE</code>: Provides the proportion of variance “explained” for each variable (<span class="math inline">\(R^2\)</span>).</li>
<li><code>standardized = TRUE</code>: Provides standardized estimates in the summary.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model01Estimates, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 39 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               387.333     467.448
  Degrees of freedom                                 9           9
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.829
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.817       0.779
  Tucker-Lewis Index (TLI)                       0.694       0.632
                                                                  
  Robust Comparative Fit Index (CFI)                         0.816
  Robust Tucker-Lewis Index (TLI)                            0.694

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11535.690  -11535.690
  Scaling correction factor                                  1.076
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               23107.380   23107.380
  Bayesian (BIC)                             23197.484   23197.484
  Sample-size adjusted Bayesian (SABIC)      23140.311   23140.311

Root Mean Square Error of Approximation:

  RMSEA                                          0.195       0.215
  90 Percent confidence interval - lower         0.179       0.197
  90 Percent confidence interval - upper         0.212       0.233
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.195
  90 Percent confidence interval - lower                     0.179
  90 Percent confidence interval - upper                     0.212
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.079       0.079

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sit =~                                                                
    Sit1r            -0.132    0.006  -21.977    0.000   -1.317   -0.735
    Sit2             -0.084    0.006  -14.718    0.000   -0.844   -0.596
    Sit3r            -0.129    0.006  -23.255    0.000   -1.287   -0.796
    Sit4             -0.082    0.006  -14.340    0.000   -0.824   -0.586
    Sit5r            -0.097    0.006  -17.607    0.000   -0.970   -0.562
    Sit6             -0.072    0.006  -12.137    0.000   -0.720   -0.477

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             4.443    0.054   82.373    0.000    4.443    2.480
   .Sit2              5.287    0.043  123.919    0.000    5.287    3.731
   .Sit3r             4.778    0.049   98.116    0.000    4.778    2.954
   .Sit4              5.314    0.042  125.550    0.000    5.314    3.780
   .Sit5r             4.761    0.052   91.624    0.000    4.761    2.759
   .Sit6              5.263    0.045  115.739    0.000    5.263    3.485
    Sit               0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             1.475    0.108   13.649    0.000    1.475    0.460
   .Sit2              1.294    0.082   15.747    0.000    1.294    0.645
   .Sit3r             0.959    0.093   10.279    0.000    0.959    0.367
   .Sit4              1.298    0.081   16.072    0.000    1.298    0.657
   .Sit5r             2.037    0.108   18.787    0.000    2.037    0.684
   .Sit6              1.762    0.088   20.034    0.000    1.762    0.772
    Sit             100.000                               1.000    1.000

R-Square:
                   Estimate
    Sit1r             0.540
    Sit2              0.355
    Sit3r             0.633
    Sit4              0.343
    Sit5r             0.316
    Sit6              0.228</code></pre>
</div>
</div>
<p>Each section contains different portions of model information.</p>
<section id="unstandardized-model-parameter-estmates" class="level4">
<h4 class="anchored" data-anchor-id="unstandardized-model-parameter-estmates">Unstandardized Model Parameter Estmates</h4>
<section id="factor-loadings-regression-slopes-of-item-response-on-factor" class="level5">
<h5 class="anchored" data-anchor-id="factor-loadings-regression-slopes-of-item-response-on-factor">FACTOR LOADINGS (regression slopes of item response on factor)</h5>
<pre><code>Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sit =~                                                                
    Sit1r             1.234    0.069   17.906    0.000    1.234    0.707
    Sit2              0.702    0.074    9.441    0.000    0.702    0.509
    Sit3r             1.241    0.063   19.847    0.000    1.241    0.778
    Sit4              0.784    0.069   11.333    0.000    0.784    0.559
    Sit5r             1.023    0.053   19.179    0.000    1.023    0.596
    Sit6              0.819    0.069   11.942    0.000    0.819    0.535</code></pre>
</section>
<section id="intercepts-of-items-here-are-actual-item-means-because-factor-mean-is-zero" class="level5">
<h5 class="anchored" data-anchor-id="intercepts-of-items-here-are-actual-item-means-because-factor-mean-is-zero">Intercepts (of Items) – HERE, ARE ACTUAL ITEM MEANS BECAUSE FACTOR MEAN IS ZERO</h5>
<p>Note: the last term in the list, <code>Sit</code> is the “intercept” (mean) of the factor. As it does not have a standard error, this indicates it was fixed to zero and not estimated.</p>
<pre><code>Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             4.547    0.053   86.474    0.000    4.547    2.604
   .Sit2              5.289    0.042  127.346    0.000    5.289    3.834
   .Sit3r             4.896    0.048  101.959    0.000    4.896    3.070
   .Sit4              5.359    0.042  126.896    0.000    5.359    3.821
   .Sit5r             4.860    0.052   94.060    0.000    4.860    2.832
   .Sit6              5.321    0.046  115.492    0.000    5.321    3.477
    Sit               0.000                               0.000    0.000</code></pre>
</section>
<section id="residual-unique-variances-variance-of-error-terms" class="level5">
<h5 class="anchored" data-anchor-id="residual-unique-variances-variance-of-error-terms">Residual (Unique) Variances (variance of error terms)</h5>
<p>Note: the last term in the list, <code>Sit</code>, is the variance of the factor. As it does not have a standard error, this indicates it was fixed to one (from the <code>std.lv = TRUE</code> option we used in the <code>lavaan()</code> function call) and not estimated.</p>
<pre><code>Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             1.526    0.149   10.217    0.000    1.526    0.500
   .Sit2              1.409    0.128   11.014    0.000    1.409    0.741
   .Sit3r             1.004    0.135    7.456    0.000    1.004    0.395
   .Sit4              1.352    0.127   10.672    0.000    1.352    0.687
   .Sit5r             1.899    0.118   16.025    0.000    1.899    0.645
   .Sit6              1.671    0.159   10.517    0.000    1.671    0.714
    Sit               1.000                               1.000    1.000</code></pre>
</section>
</section>
<section id="making-use-of-the-unstandardized-model-estimates" class="level4">
<h4 class="anchored" data-anchor-id="making-use-of-the-unstandardized-model-estimates">Making use of the unstandardized model estimates:</h4>
<p><em>Writing out the model—individual predicted values:</em></p>
<ul>
<li><span class="math inline">\(Y_1 = \mu_1 + \lambda_1F + e_1 = 4.547 + 1.234F + e_1\)</span></li>
</ul>
<p><em>Writing out the model—predicted item variances and covariances:</em></p>
<ul>
<li><p><span class="math inline">\(Var\left( Y_1 \right) = \left( \lambda^2_1 \right) Var\left(F\right) + Var\left(e_1\right) = (1.234^2)*(1) + 1.526 = 3.049\)</span> (= original item variance)</p></li>
<li><p><span class="math inline">\(Cov\left( Y_1, Y_2 \right) = \lambda_1 Var\left(F\right) \lambda_2 = (1.234)*(1)*(.702) = .866\)</span> (actual covariance = .577, so the model over-predicted how related items 1 and 2 should be)</p></li>
</ul>
</section>
<section id="plotting-path-diagrams" class="level4">
<h4 class="anchored" data-anchor-id="plotting-path-diagrams">Plotting Path Diagrams</h4>
<p>The R package semPlot helps provide a path diagram of a model. Here is an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(<span class="at">object =</span> model01Estimates, <span class="at">what =</span> <span class="st">"std"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/pathdiagram-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="standardized-model-parameter-estimates" class="level4">
<h4 class="anchored" data-anchor-id="standardized-model-parameter-estimates">Standardized Model Parameter Estimates</h4>
<p>The last two columns of the summary output, <code>Std.lv</code> and <code>Std.all</code>, contain the standardized model parameter estimates. To understand the difference between standardized and unstandardized parameter estimates, let’s start with the standardized estimates. Standardized regression coefficients (and factor loadings) have a scale that is “units of Y” per “unit of X”. That is, the slope/loading, represents the increase in the dependent variable <span class="math inline">\(X\)</span> per unit of the independent variable <span class="math inline">\(X\)</span> (in our case, the factor). The units of <span class="math inline">\(Y\)</span> are given by the standard deviation of <span class="math inline">\(Y\)</span>, or <span class="math inline">\(SD(Y)\)</span>. Similarly, the units of <span class="math inline">\(X\)</span> are given by the standard deviation of <span class="math inline">\(X\)</span>, or <span class="math inline">\(SD(X)\)</span>. You can think of the units associated by the fraction <span class="math inline">\(\frac{SD(Y)}{SD(X)}\)</span>. So, the first factor loading (a value of 1.234 for the item Sit1r) indicates the numeric response to the item goes up by 1.234 for every one-unit increase in the factor Sit.</p>
<p>The process of standardization removes the units attached to the parameter. So, if the unstandardized factor loadings are expressed in units of <span class="math inline">\(\frac{SD(Y)}{SD(X)}\)</span>, the standardized units are achieved by either dividing or multiplying by the appropriate standard deviation to make the numerator or denominator of <span class="math inline">\(\frac{SD(Y)}{SD(X)}\)</span> equal to one. For the standardized estimates under <code>std.lv</code>, the units of the factor <span class="math inline">\((SD(X))\)</span> are removed (yielding <span class="math inline">\(\frac{SD(Y)}{1}\)</span>) by multiplying the estimate by the factor standard deviation. Because the factor standard deviation is set to one, all estimates in this column are the same as the unstandardized estimate. These unstandardized estimates can be used to see how parameters would look under the Z-score identification method another identification method was used.</p>
<p>The standardized estimates listed under <code>std.all</code> are formed by multiplying the estimate by the standard deviation of the factor and dividing that by the unconditional (raw) standard deviation of the item. For instance, the “fully” standardized factor loading of the first item is found by multiplying the unstandardized coefficient (1.234) by one (the factor standard deviation) and dividing by the item’s standard deviation (<span class="math inline">\(\sqrt{3.049}\)</span> – the square root of the item variance shown at the beginning of this example). The resulting value, <span class="math inline">\(1.234\times\frac{1}{\sqrt{3.049}} = 0.707\)</span>, represents the factor loading would the analysis have been run (a) with a Z-score factor identification and (b) on an item that was a Z-score.</p>
<p>The process of standardization is the same for all parameters of the model: intercepts, loadings, and residual (unique) variances. The interpretation of standardized item intercepts is difficult and often these are not reported. The standardized versions of factor loadings and unique variances are commonly reported.</p>
<p>Moreover, in for items measuring one factor, the standardized loadings lead directly to the <span class="math inline">\(R^2\)</span> estimate – the amount of variance in the item responses explained by the factor. The item <span class="math inline">\(R^2\)</span> is found by the square of the unstandardized factor loading. The R-Square information is found at the end of the model summary, so long as the option <code>rsquare = TRUE</code> is specified in the <code>summary()</code> function call.</p>
<pre><code>R-Square:
                   Estimate
    Sit1r             0.500
    Sit2              0.259
    Sit3r             0.605
    Sit4              0.313
    Sit5r             0.355
    Sit6              0.286</code></pre>
</section>
</section>
<section id="shortening-lavaan-syntax-lavaan-default-options" class="level3">
<h3 class="anchored" data-anchor-id="shortening-lavaan-syntax-lavaan-default-options">Shortening Lavaan Syntax: Lavaan Default Options</h3>
<p>The syntax above is designed to show the mapping of all CFA parameters to all lavaan syntax elements. In reality, all you would need to write to define this model is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model01SyntaxShort <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="st">Sit =~ Sit1r + Sit2 + Sit3r + Sit4 + Sit5r + Sit6</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The syntax input into the <code>sem()</code> function uses some defaults:</p>
<ul>
<li>All item intercepts are estimated (each item gets its own) and the factor mean is fixed at zero.</li>
<li>All item error (unique) variances are estimated (each item gets its own).</li>
<li>All factor variances and covariances are estimated (to do so, the first item after the =~ has its factor loading set to 1 – a marker item identification method)</li>
</ul>
<p>Similarly, to run this syntax the <code>sem</code> function is now called. To see the results, the <code>summary</code> function is used. The <code>sem</code> function simplifies the syntax needed to conduct a confirmatory factor analysis. These are demonstrated below. Note the output is identical to what was run previously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>model01EstimatesShort <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model01SyntaxShort, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model01EstimatesShort, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 21 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               387.333     467.447
  Degrees of freedom                                 9           9
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.829
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.817       0.779
  Tucker-Lewis Index (TLI)                       0.694       0.632
                                                                  
  Robust Comparative Fit Index (CFI)                         0.816
  Robust Tucker-Lewis Index (TLI)                            0.694

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11535.690  -11535.690
  Scaling correction factor                                  1.076
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               23107.380   23107.380
  Bayesian (BIC)                             23197.484   23197.484
  Sample-size adjusted Bayesian (SABIC)      23140.311   23140.311

Root Mean Square Error of Approximation:

  RMSEA                                          0.195       0.215
  90 Percent confidence interval - lower         0.179       0.197
  90 Percent confidence interval - upper         0.212       0.233
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.195
  90 Percent confidence interval - lower                     0.179
  90 Percent confidence interval - upper                     0.212
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.079       0.079

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sit =~                                                                
    Sit1r             1.317    0.060   21.977    0.000    1.317    0.735
    Sit2              0.844    0.057   14.718    0.000    0.844    0.596
    Sit3r             1.287    0.055   23.255    0.000    1.287    0.796
    Sit4              0.824    0.057   14.340    0.000    0.824    0.586
    Sit5r             0.970    0.055   17.607    0.000    0.970    0.562
    Sit6              0.720    0.059   12.137    0.000    0.720    0.477

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             4.443    0.054   82.373    0.000    4.443    2.480
   .Sit2              5.287    0.043  123.919    0.000    5.287    3.731
   .Sit3r             4.778    0.049   98.116    0.000    4.778    2.954
   .Sit4              5.314    0.042  125.550    0.000    5.314    3.780
   .Sit5r             4.761    0.052   91.624    0.000    4.761    2.759
   .Sit6              5.263    0.045  115.739    0.000    5.263    3.485

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             1.475    0.108   13.649    0.000    1.475    0.460
   .Sit2              1.294    0.082   15.747    0.000    1.294    0.645
   .Sit3r             0.959    0.093   10.279    0.000    0.959    0.367
   .Sit4              1.298    0.081   16.072    0.000    1.298    0.657
   .Sit5r             2.037    0.108   18.787    0.000    2.037    0.684
   .Sit6              1.762    0.088   20.034    0.000    1.762    0.772
    Sit               1.000                               1.000    1.000

R-Square:
                   Estimate
    Sit1r             0.540
    Sit2              0.355
    Sit3r             0.633
    Sit4              0.343
    Sit5r             0.316
    Sit6              0.228</code></pre>
</div>
</div>
</section>
<section id="alternative-identification-methods" class="level3">
<h3 class="anchored" data-anchor-id="alternative-identification-methods">Alternative Identification Methods</h3>
<p>There are multiple equivalent ways of getting the same CFA model, but with different scaling for the factor mean and variance (i.e., different means of identification). Now let’s see the model parameters when using the marker item for model identification instead. In the marker item identification method:</p>
<ul>
<li>The first factor loading of a factor (the first variable after the <code>=~</code> symbol in <code>lavaan</code> syntax) is set to one</li>
<li>The factor variance is estimated</li>
<li>The factor mean is set to zero</li>
<li>All item intercepts and unique variances are estimated (as done in the Z-score identification method)</li>
</ul>
<section id="factor-mean-zero-factor-variance-estimated-marker-item-factor-loading" class="level4">
<h4 class="anchored" data-anchor-id="factor-mean-zero-factor-variance-estimated-marker-item-factor-loading">Factor Mean Zero; Factor Variance Estimated (marker item factor loading)</h4>
<p>The <code>lavaan</code> syntax is the same for the marker item identification, but the call to the <code>lavaan()</code> function does not include the <code>std.lv = TRUE</code> option, which defaults to the marker item method of identification:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>model02Estimates <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model01SyntaxShort, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model02Estimates, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 26 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               387.333     467.449
  Degrees of freedom                                 9           9
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.829
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.817       0.779
  Tucker-Lewis Index (TLI)                       0.694       0.632
                                                                  
  Robust Comparative Fit Index (CFI)                         0.816
  Robust Tucker-Lewis Index (TLI)                            0.694

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11535.690  -11535.690
  Scaling correction factor                                  1.076
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               23107.380   23107.380
  Bayesian (BIC)                             23197.484   23197.484
  Sample-size adjusted Bayesian (SABIC)      23140.311   23140.311

Root Mean Square Error of Approximation:

  RMSEA                                          0.195       0.215
  90 Percent confidence interval - lower         0.179       0.197
  90 Percent confidence interval - upper         0.212       0.233
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.195
  90 Percent confidence interval - lower                     0.179
  90 Percent confidence interval - upper                     0.212
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.079       0.079

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sit =~                                                                
    Sit1r             1.000                               1.317    0.735
    Sit2              0.641    0.060   10.741    0.000    0.844    0.596
    Sit3r             0.977    0.036   27.335    0.000    1.287    0.796
    Sit4              0.625    0.059   10.586    0.000    0.824    0.586
    Sit5r             0.737    0.041   17.832    0.000    0.970    0.562
    Sit6              0.547    0.058    9.445    0.000    0.720    0.477

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             4.443    0.054   82.373    0.000    4.443    2.480
   .Sit2              5.287    0.043  123.919    0.000    5.287    3.731
   .Sit3r             4.778    0.049   98.116    0.000    4.778    2.954
   .Sit4              5.314    0.042  125.550    0.000    5.314    3.780
   .Sit5r             4.761    0.052   91.624    0.000    4.761    2.759
   .Sit6              5.263    0.045  115.739    0.000    5.263    3.485

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             1.475    0.108   13.649    0.000    1.475    0.460
   .Sit2              1.294    0.082   15.747    0.000    1.294    0.645
   .Sit3r             0.959    0.093   10.279    0.000    0.959    0.367
   .Sit4              1.298    0.081   16.072    0.000    1.298    0.657
   .Sit5r             2.037    0.108   18.787    0.000    2.037    0.684
   .Sit6              1.762    0.088   20.034    0.000    1.762    0.772
    Sit               1.734    0.158   10.988    0.000    1.000    1.000

R-Square:
                   Estimate
    Sit1r             0.540
    Sit2              0.355
    Sit3r             0.633
    Sit4              0.343
    Sit5r             0.316
    Sit6              0.228</code></pre>
</div>
</div>
</section>
<section id="unstandardized-model-results" class="level4">
<h4 class="anchored" data-anchor-id="unstandardized-model-results">Unstandardized Model Results</h4>
<section id="factor-loadings-regression-slopes-of-item-response-on-factor-1" class="level5">
<h5 class="anchored" data-anchor-id="factor-loadings-regression-slopes-of-item-response-on-factor-1">FACTOR LOADINGS (regression slopes of item response on factor)</h5>
<p>Here, loading for SIT1R is not tested and has no standard error (<code>Std.Err</code>) because it is fixed to one. Also, note the <code>Std.lv</code> estimates are identical to the unstandardized estimates in the Z-score factor identification method. Further, the <code>Std.all</code> estimates are equal to the <code>Std.all</code> estimates in the Z-score factor identification method. These will be equal for all identification methods.</p>
<pre><code>Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sit =~                                                                
    Sit1r             1.000                               1.317    0.735
    Sit2              0.641    0.060   10.741    0.000    0.844    0.596
    Sit3r             0.977    0.036   27.335    0.000    1.287    0.796
    Sit4              0.625    0.059   10.586    0.000    0.824    0.586
    Sit5r             0.737    0.041   17.832    0.000    0.970    0.562
    Sit6              0.547    0.058    9.445    0.000    0.720    0.477</code></pre>
</section>
<section id="intercepts-of-items-expected-y-when-factor-0-or-for-mean-of-factor-in-sample" class="level5">
<h5 class="anchored" data-anchor-id="intercepts-of-items-expected-y-when-factor-0-or-for-mean-of-factor-in-sample">Intercepts (of Items) – EXPECTED Y WHEN FACTOR = 0, or for mean of factor in sample</h5>
<p>Here, all are identical to what was found in the previous Z-score standardization. That is because we left the factor mean to be zero.</p>
<pre><code>Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             4.443    0.054   82.373    0.000    4.443    2.480
   .Sit2              5.287    0.043  123.919    0.000    5.287    3.731
   .Sit3r             4.778    0.049   98.116    0.000    4.778    2.954
   .Sit4              5.314    0.042  125.550    0.000    5.314    3.780
   .Sit5r             4.761    0.052   91.624    0.000    4.761    2.759
   .Sit6              5.263    0.045  115.739    0.000    5.263    3.485
    Sit               0.000                               0.000    0.000</code></pre>
</section>
<section id="residual-unique-variances-and-factor-variance" class="level5">
<h5 class="anchored" data-anchor-id="residual-unique-variances-and-factor-variance">Residual (unique) variances and factor variance</h5>
<p>Here, the factor variance is estimated, which is different from the previous identification method.</p>
<pre><code>Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             1.475    0.108   13.649    0.000    1.475    0.460
   .Sit2              1.294    0.082   15.747    0.000    1.294    0.645
   .Sit3r             0.959    0.093   10.279    0.000    0.959    0.367
   .Sit4              1.298    0.081   16.072    0.000    1.298    0.657
   .Sit5r             2.037    0.108   18.787    0.000    2.037    0.684
   .Sit6              1.762    0.088   20.034    0.000    1.762    0.772
    Sit               1.734    0.158   10.988    0.000    1.000    1.000</code></pre>
</section>
</section>
<section id="estimating-factor-means-marker-item-loading-1-and-marker-item-intercept-0" class="level4">
<h4 class="anchored" data-anchor-id="estimating-factor-means-marker-item-loading-1-and-marker-item-intercept-0">Estimating Factor Means: Marker Item Loading (=1) and Marker Item Intercept (=0)</h4>
<p>To estimate this model, we have to return to the general <code>lavaan</code> model function. In the syntax below you see <code>1*Sit1r</code>, setting the factor loading for <code>Sit1r</code> to one (the marker item factor loading). Further, you see <code>Sit1r ~ 0</code> setting the item intercept of <code>Sit1r</code> to zero, the marker item intercept. Finally, to estimate the factor mean, we use <code>Sit ~ 1</code>, which estimates the factor mean explicitly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>model03Syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="st"># Model 1 --  Fully Z-Scored Factor Identification Approach</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="st"># Item factor loadings --&gt; list the factor to the left of the =~ and the items to the right, separated by a plus</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="st"># Once the factor is defined it can be used in syntax as if it is an observed variable</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="st"># Parameters can be fixed to constant values by using the * command; starting values can be specified by using start()*; labels can be implemented with []</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="st">Sit =~ 1*Sit1r + Sit2 + Sit3r + Sit4 + Sit5r + Sit6</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="st"># Item intercepts --&gt; ~ 1 indicates means or intercepts</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="st"># You can put multiple lines of syntax on a single line using a ; </span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~ 0; Sit2 ~ 1; Sit3r  ~ 1; Sit4 ~ 1; Sit5r ~ 1; Sit6 ~ 1;</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="st"># Item error (unique) variances and covariances --&gt; use the ~~ command</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ Sit1r; Sit2 ~~ Sit2; Sit3r ~~ Sit3r; Sit4 ~~ Sit4; Sit5r ~~ Sit5r; Sit6 ~~ Sit6; </span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="st"># Factor variance</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="st">Sit ~~ Sit</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="st"># Factor mean (intercept)</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="st">Sit ~ 1</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>model03Estimates <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model03Syntax, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model03Estimates, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 54 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               387.333     467.447
  Degrees of freedom                                 9           9
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.829
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.817       0.779
  Tucker-Lewis Index (TLI)                       0.694       0.632
                                                                  
  Robust Comparative Fit Index (CFI)                         0.816
  Robust Tucker-Lewis Index (TLI)                            0.694

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11535.690  -11535.690
  Scaling correction factor                                  1.076
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               23107.380   23107.380
  Bayesian (BIC)                             23197.484   23197.484
  Sample-size adjusted Bayesian (SABIC)      23140.311   23140.311

Root Mean Square Error of Approximation:

  RMSEA                                          0.195       0.215
  90 Percent confidence interval - lower         0.179       0.197
  90 Percent confidence interval - upper         0.212       0.233
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.195
  90 Percent confidence interval - lower                     0.179
  90 Percent confidence interval - upper                     0.212
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.079       0.079

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sit =~                                                                
    Sit1r             1.000                               1.317    0.735
    Sit2              0.641    0.060   10.741    0.000    0.844    0.596
    Sit3r             0.977    0.036   27.335    0.000    1.287    0.796
    Sit4              0.625    0.059   10.586    0.000    0.824    0.586
    Sit5r             0.737    0.041   17.832    0.000    0.970    0.562
    Sit6              0.547    0.058    9.445    0.000    0.720    0.477

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             0.000                               0.000    0.000
   .Sit2              2.438    0.268    9.112    0.000    2.438    1.720
   .Sit3r             0.436    0.162    2.682    0.007    0.436    0.269
   .Sit4              2.536    0.265    9.558    0.000    2.536    1.804
   .Sit5r             1.488    0.192    7.768    0.000    1.488    0.862
   .Sit6              2.833    0.261   10.862    0.000    2.833    1.876
    Sit               4.443    0.054   82.373    0.000    3.374    3.374

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             1.475    0.108   13.649    0.000    1.475    0.460
   .Sit2              1.294    0.082   15.747    0.000    1.294    0.645
   .Sit3r             0.959    0.093   10.279    0.000    0.959    0.367
   .Sit4              1.298    0.081   16.072    0.000    1.298    0.657
   .Sit5r             2.037    0.108   18.787    0.000    2.037    0.684
   .Sit6              1.762    0.088   20.034    0.000    1.762    0.772
    Sit               1.734    0.158   10.988    0.000    1.000    1.000

R-Square:
                   Estimate
    Sit1r             0.540
    Sit2              0.355
    Sit3r             0.633
    Sit4              0.343
    Sit5r             0.316
    Sit6              0.228</code></pre>
</div>
</div>
<p>Here, you will note the model is identical to the previous two – the log-likelihood is 11535.690, same as previously. Now, the intercepts has the mean of item <code>Sit1r</code> set to zero and the mean of the factor estimated.</p>
<pre><code>Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r             0.000                               0.000    0.000
   .Sit2              2.438    0.268    9.112    0.000    2.438    1.720
   .Sit3r             0.436    0.162    2.682    0.007    0.436    0.269
   .Sit4              2.536    0.265    9.558    0.000    2.536    1.804
   .Sit5r             1.488    0.192    7.768    0.000    1.488    0.862
   .Sit6              2.833    0.261   10.862    0.000    2.833    1.876
    Sit               4.443    0.054   82.373    0.000    3.374    3.374</code></pre>
<p>The mean of the factor is 4.443, which, in this case, is the mean of item <code>Sit1r</code>. That is because the factor loading of the item is set to 1.0. You will also notice that the other item intercepts have changed from previous models. In general, an item’s mean is found by adding the item intercept to the product of the factor loading times the factor mean, or <span class="math inline">\(\mu_i + \lambda_i\mu_F\)</span>.</p>
</section>
</section>
<section id="model-fit-information-for-a-single-factor-model-same-regardless-of-factor-scaling-method" class="level3">
<h3 class="anchored" data-anchor-id="model-fit-information-for-a-single-factor-model-same-regardless-of-factor-scaling-method">Model Fit Information for a Single-Factor Model (same regardless of factor scaling method):</h3>
<p>Calculating model degrees of freedom (v is number of observed variables in a model):</p>
<ul>
<li>Total df = <span class="math inline">\(\frac{v(v+1)}{2} + v = 27\)</span></li>
<li>Number of parameters in our model: 18</li>
<li>Degrees of freedom = 27-18 = 9</li>
</ul>
<section id="loglikelihood-use-for-testing-differences-in-model-fit-across-nested-models" class="level4">
<h4 class="anchored" data-anchor-id="loglikelihood-use-for-testing-differences-in-model-fit-across-nested-models">Loglikelihood – use for testing differences in model fit across nested models</h4>
<pre><code>Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11535.690  -11535.690
  Scaling correction factor                                  1.076
    for the MLR correction
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
    for the MLR correction</code></pre>
<ul>
<li>Loglikelihood user model (H0): this is for your specified model</li>
<li>Scaling correction factor for the MLR correction: indicates how far off from normal=1</li>
<li>H1 Value: this is for a saturated (perfect) model</li>
</ul>
</section>
<section id="information-criteria-smaller-is-better-use-for-nested-or-non-nested-model-comparisons" class="level4">
<h4 class="anchored" data-anchor-id="information-criteria-smaller-is-better-use-for-nested-or-non-nested-model-comparisons">Information Criteria “smaller is better” – use for nested or non-nested model comparisons</h4>
<pre><code>  Number of free parameters                         18          18
  Akaike (AIC)                               23107.380   23107.380
  Bayesian (BIC)                             23197.484   23197.484
  Sample-size adjusted Bayesian (BIC)        23140.311   23140.311</code></pre>
<ul>
<li>is # of estimated parameters (“free” to be not 0)</li>
<li>AIC = (-2<em><span class="math inline">\(LL_{H0}\)</span>) + (2</em>estimated parameters)</li>
<li>BIC = (-2<em><span class="math inline">\(LL_{H0}\)</span>) + (LN N</em>estimated parameters)</li>
<li>Sample-size adjusted Bayesian (BIC) = BIC replacing N with (N + 2) / 24</li>
</ul>
</section>
<section id="chi-square-test-of-model-fit-significance-is-bad-here-for-your-specified-model" class="level4">
<h4 class="anchored" data-anchor-id="chi-square-test-of-model-fit-significance-is-bad-here-for-your-specified-model">Chi-Square Test of Model Fit (Significance is bad here) for your specified model</h4>
<pre><code>  Estimator                                         ML      Robust
  Minimum Function Test Statistic              387.333     467.447
  Degrees of freedom                                 9           9
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.829
    for the Yuan-Bentler correction (Mplus variant)</code></pre>
<ul>
<li>Estimator: Look at robust column for MLR version of test</li>
<li>Minimum Function Test Statistic: leftover after estimating our one-factor model</li>
<li>Scaling correction factor for the Yuan-Bentler correction (Mplus variant): indicates how far off from normal=1</li>
</ul>
<p>Where does this <span class="math inline">\(\chi^2\)</span> value for “model fit” come from? A rescaled −2LL model comparison of this one-factor model (H0) against the saturated model (H1) that perfectly reproduces the data covariances.</p>
</section>
<section id="where-the-saturated-h1-model-comes-from-all-means-variances-and-covariances-estimated" class="level4">
<h4 class="anchored" data-anchor-id="where-the-saturated-h1-model-comes-from-all-means-variances-and-covariances-estimated">Where the Saturated (H1) Model Comes From: All Means, Variances, and Covariances Estimated</h4>
<p>How to fit the saturated (Unstructured) Baseline Model: Item means, variances, and covariances in original data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>modelSaturated <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Item intercepts --&gt; ~ 1 indicates means or intercepts</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="st"># You can put multiple lines of syntax on a single line using a ; </span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~ 1; Sit2 ~ 1; Sit3r  ~ 1; Sit4 ~ 1; Sit5r ~ 1; Sit6 ~ 1;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="st"># Item variances and covariances --&gt; use the ~~ command</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="st"># Variances:</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ Sit1r; Sit2 ~~ Sit2; Sit3r ~~ Sit3r; Sit4 ~~ Sit4; Sit5r ~~ Sit5r; Sit6 ~~ Sit6; </span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="st"># Covariances:</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ Sit2; Sit1r ~~ Sit3r; Sit1r ~~ Sit4; Sit1r ~~ Sit5r; Sit1r ~~ Sit6;</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="st">Sit2 ~~ Sit3r; Sit2 ~~ Sit4; Sit2 ~~ Sit5r; Sit2 ~~ Sit6;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="st">Sit3r ~~ Sit4; Sit3r ~~ Sit5r; Sit3r ~~ Sit6;</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="st">Sit4 ~~ Sit5r; Sit4 ~~ Sit6;</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="st">Sit5r ~~ Sit6;</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>modelSaturatedEstimates <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> modelSaturated, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelSaturatedEstimates, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 43 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11342.023  -11342.023
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
                                                                  
  Akaike (AIC)                               22738.046   22738.046
  Bayesian (BIC)                             22873.202   22873.202
  Sample-size adjusted Bayesian (SABIC)      22787.444   22787.444

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  Sit1r ~~                                            
    Sit2              0.914    0.082   11.196    0.000
    Sit3r             1.905    0.104   18.284    0.000
    Sit4              0.876    0.082   10.619    0.000
    Sit5r             1.391    0.102   13.625    0.000
    Sit6              0.768    0.084    9.124    0.000
  Sit2 ~~                                             
    Sit3r             0.945    0.074   12.780    0.000
    Sit4              1.170    0.068   17.317    0.000
    Sit5r             0.629    0.073    8.563    0.000
    Sit6              0.994    0.070   14.145    0.000
  Sit3r ~~                                            
    Sit4              0.909    0.072   12.555    0.000
    Sit5r             1.386    0.093   14.842    0.000
    Sit6              0.769    0.076   10.190    0.000
  Sit4 ~~                                             
    Sit5r             0.673    0.072    9.323    0.000
    Sit6              0.934    0.066   14.093    0.000
  Sit5r ~~                                            
    Sit6              0.502    0.078    6.398    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Sit1r             4.443    0.054   82.373    0.000
    Sit2              5.287    0.043  123.919    0.000
    Sit3r             4.778    0.049   98.116    0.000
    Sit4              5.314    0.042  125.550    0.000
    Sit5r             4.761    0.052   91.624    0.000
    Sit6              5.263    0.045  115.739    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Sit1r             3.209    0.136   23.508    0.000
    Sit2              2.007    0.084   23.894    0.000
    Sit3r             2.616    0.107   24.399    0.000
    Sit4              1.976    0.084   23.409    0.000
    Sit5r             2.979    0.129   23.086    0.000
    Sit6              2.281    0.097   23.540    0.000</code></pre>
</div>
</div>
<p>Note that H0 and H1 are now the same! Our H0 model IS the H1 saturated model: the log-likelihood of H0 and H1 are the same. Also, note there are 27 free parameters (six item means, six item variances, and 15 covariances).</p>
<pre><code>Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11342.023  -11342.023
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023

  Number of free parameters                         27          27
  Akaike (AIC)                               22738.046   22738.046
  Bayesian (BIC)                             22873.202   22873.202
  Sample-size adjusted Bayesian (BIC)        22787.444   22787.444</code></pre>
<p>Also note how the model <span class="math inline">\(\chi^2\)</span> test has zero degrees of freedom: this is because all 27 possible free parameters were estimated. This model fits the data perfectly.</p>
<pre><code>  Estimator                                         ML      Robust
  Minimum Function Test Statistic                0.000       0.000
  Degrees of freedom                                 0           0
  Minimum Function Value               0.0000000000000
  Scaling correction factor                                     NA
    for the Yuan-Bentler correction (Mplus variant)</code></pre>
</section>
<section id="the-rest-of-the-one-factor-model-fit-statistics" class="level4">
<h4 class="anchored" data-anchor-id="the-rest-of-the-one-factor-model-fit-statistics">The Rest of the One-Factor Model Fit Statistics</h4>
<pre><code>User model versus baseline model:

  Comparative Fit Index (CFI)                    0.817       0.779
  Tucker-Lewis Index (TLI)                       0.694       0.632

  Robust Comparative Fit Index (CFI)                         0.816
  Robust Tucker-Lewis Index (TLI)                            0.693
  
Root Mean Square Error of Approximation:

  RMSEA                                          0.195       0.215
  90 Percent Confidence Interval          0.179  0.212       0.197  0.233
  P-value RMSEA &lt;= 0.05                          0.000       0.000

  Robust RMSEA                                               0.196
  90 Percent Confidence Interval                             0.181  0.211

Standardized Root Mean Square Residual:

  SRMR                                           0.079       0.079</code></pre>
<ul>
<li>CFI/TLI: Want close to one (1 = saturated model)</li>
<li>RMSEA: Want close to zero (0 = saturated model)</li>
<li>SRMR (Standardized Root Mean Square Residual): want close to zero (0 = saturated model)</li>
</ul>
</section>
<section id="chi-square-test-of-model-fit-for-the-baseline-model-for-the-no-covariances-model" class="level4">
<h4 class="anchored" data-anchor-id="chi-square-test-of-model-fit-for-the-baseline-model-for-the-no-covariances-model">Chi-Square Test of Model Fit for the Baseline Model (for the “no covariances” model)</h4>
<p>This compares the estimated model to the one that has no covariances. It is a last-resort type model in that if the estimated model has a test with a non-significant p-value, then this indicates there will be no factors to be found in the data.</p>
<pre><code>Model test baseline model:

  Minimum Function Test Statistic             2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000</code></pre>
<p>Where does this <span class="math inline">\(\chi^2\)</span> value for “fit of the baseline model” come from? A rescaled −2LL model comparison of the independence model with NO covariances to the saturated model.</p>
<p>What’s the point? This baseline model fit test tells us whether there are any covariances at all (i.e., whether it even makes sense to try to fit latent factors to predict them).</p>
</section>
<section id="how-to-fit-the-independence-null-baseline-model-item-means-and-variances-but-no-covariances" class="level4">
<h4 class="anchored" data-anchor-id="how-to-fit-the-independence-null-baseline-model-item-means-and-variances-but-no-covariances">How to fit the Independence (Null) Baseline Model: Item means and variances, but NO covariances</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>modelIndependence <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Item intercepts --&gt; ~ 1 indicates means or intercepts</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="st"># You can put multiple lines of syntax on a single line using a ; </span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~ 1; Sit2 ~ 1; Sit3r  ~ 1; Sit4 ~ 1; Sit5r ~ 1; Sit6 ~ 1;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="st"># Item variances and covariances --&gt; use the ~~ command</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="st"># Variances:</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ Sit1r; Sit2 ~~ Sit2; Sit3r ~~ Sit3r; Sit4 ~~ Sit4; Sit5r ~~ Sit5r; Sit6 ~~ Sit6; </span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>modelIndependenceEstimates <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> modelIndependence, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelIndependenceEstimates, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 12 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        12

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.993
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.000       0.000
  Tucker-Lewis Index (TLI)                      -0.000       0.000
                                                                  
  Robust Comparative Fit Index (CFI)                         0.000
  Robust Tucker-Lewis Index (TLI)                           -0.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -12380.518  -12380.518
  Scaling correction factor                                  0.994
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               24785.036   24785.036
  Bayesian (BIC)                             24845.106   24845.106
  Sample-size adjusted Bayesian (SABIC)      24806.991   24806.991

Root Mean Square Error of Approximation:

  RMSEA                                          0.353       0.354
  90 Percent confidence interval - lower         0.340       0.341
  90 Percent confidence interval - upper         0.366       0.367
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.353
  90 Percent confidence interval - lower                     0.340
  90 Percent confidence interval - upper                     0.366
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.309       0.309

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Sit1r             4.443    0.054   82.373    0.000
    Sit2              5.287    0.043  123.919    0.000
    Sit3r             4.778    0.049   98.116    0.000
    Sit4              5.314    0.042  125.550    0.000
    Sit5r             4.761    0.052   91.624    0.000
    Sit6              5.263    0.045  115.739    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Sit1r             3.209    0.136   23.508    0.000
    Sit2              2.007    0.084   23.894    0.000
    Sit3r             2.616    0.107   24.399    0.000
    Sit4              1.976    0.084   23.409    0.000
    Sit5r             2.979    0.129   23.086    0.000
    Sit6              2.281    0.097   23.540    0.000</code></pre>
</div>
</div>
<p>Note how the test of the model vs.&nbsp;saturated is identical to the test of the model vs.&nbsp;baseline: that indicates this model is the baseline model.</p>
<p>Although not 0, this is the worst possible RMSEA while still allowing separate means and variances per item in these data. RMSEA is a parsimony-corrected absolute fit index (so, its fit is relative to the saturated model).</p>
<p>CFI and TLI are 0 because they are “incremental fit” indices relative to the independence model (which this is).</p>
<p>SRMR is also an absolute fit index (relative to saturated model), so this is the worst it gets for these data, too.</p>
</section>
</section>
<section id="poor-model-fit-need-for-model-modifications" class="level3">
<h3 class="anchored" data-anchor-id="poor-model-fit-need-for-model-modifications">Poor Model Fit: Need for Model Modifications</h3>
<p>For this section, any of the three equivalent single factor models can be used.</p>
<section id="modification-indices" class="level4">
<h4 class="anchored" data-anchor-id="modification-indices">Modification Indices</h4>
<p>So global fit for the one-factor model is not so good (RMSEA = .173, CFI = .732). What do the voodoo modification indices suggest we do to fix it? To get modification indices, use the <code>modificationindices()</code> function. Here, the function is called with options:</p>
<ul>
<li><code>object = model01Estimates</code>: The model estimates object from which to derive modification indices.</li>
<li><code>sort. = TRUE</code>: Sort the output from highest to lowest modification index.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(<span class="at">object =</span> model01Estimates, <span class="at">sort. =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lhs op   rhs      mi    epc sepc.lv sepc.all sepc.nox
27  Sit2 ~~  Sit4 202.064  0.648   0.648    0.500    0.500
22 Sit1r ~~ Sit3r 146.031  0.890   0.890    0.749    0.749
29  Sit2 ~~  Sit6  89.803  0.482   0.482    0.319    0.319
34  Sit4 ~~  Sit6  69.493  0.423   0.423    0.280    0.280
30 Sit3r ~~  Sit4  47.610 -0.356  -0.356   -0.319   -0.319
23 Sit1r ~~  Sit4  45.764 -0.380  -0.380   -0.275   -0.275
26  Sit2 ~~ Sit3r  43.492 -0.344  -0.344   -0.309   -0.309
21 Sit1r ~~  Sit2  42.221 -0.368  -0.368   -0.267   -0.267
32 Sit3r ~~  Sit6  31.735 -0.308  -0.308   -0.237   -0.237
31 Sit3r ~~ Sit5r  23.728  0.307   0.307    0.219    0.219
25 Sit1r ~~  Sit6  21.819 -0.284  -0.284   -0.176   -0.176
28  Sit2 ~~ Sit5r  20.240 -0.254  -0.254   -0.156   -0.156
35 Sit5r ~~  Sit6  14.538 -0.240  -0.240   -0.127   -0.127
33  Sit4 ~~ Sit5r   8.742 -0.166  -0.166   -0.102   -0.102
24 Sit1r ~~ Sit5r   8.194  0.197   0.197    0.114    0.114</code></pre>
</div>
</div>
<p>The output includes:</p>
<ul>
<li><code>lhs</code>: Left hand side for parameter (in <code>lavaan</code> syntax)</li>
<li><code>op</code>: Operation of parameter: <code>~~</code> is for (residual) covariances; <code>=~</code> is for additional factor loadings. All other <code>lavaan</code> syntax types are possible, too, but here item means and variances fit perfectly (see below)</li>
<li><code>rhs</code>: Right hand side for parameter (in <code>lavaan</code> syntax)</li>
<li><code>mi</code>: Modification index using ML</li>
<li><code>mi.scaled</code>: Modification index using MLR (use this one)</li>
<li><code>epc</code>: Expected parameter change (from zero)</li>
<li><code>sepc.lv</code>: Standardized expected parameter change using <code>std.lv</code> standardization</li>
<li><code>sepc.all</code>: Standardized expected parameter change using <code>std.all</code> standardization</li>
<li><code>sepc.nox</code>: Standardized expected parameter change using <code>std.nox</code> standardization</li>
</ul>
<p>Highest values are for error covariances (for unknown multidimensionality).</p>
</section>
<section id="another-approach-residual-covariance-matrices" class="level4">
<h4 class="anchored" data-anchor-id="another-approach-residual-covariance-matrices">Another approach: Residual Covariance Matrices</h4>
<p>Another approach—how about we examine local fit and see where the problems seem to be?</p>
<p>The means and variances of the items will be perfectly reproduced, so that’s not an issue. Misfit results from the difference between the observed and model-predicted covariances.</p>
<p><code>lavaan</code> gives us the “residual” (defined as observed – predicted) or “leftover” covariance matrix, but it is scale dependent and thus not so helpful. We can use the <code>resid()</code> function to obtain the residual covariance matrix (observed covariances minus model-implied covariances):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(<span class="at">object =</span> model01Estimates, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
       Sit1r   Sit2  Sit3r   Sit4  Sit5r   Sit6
Sit1r  0.000                                   
Sit2  -0.198  0.000                            
Sit3r  0.210 -0.142  0.000                     
Sit4  -0.209  0.475 -0.151  0.000              
Sit5r  0.113 -0.191  0.137 -0.126  0.000       
Sit6  -0.181  0.385 -0.158  0.341 -0.197  0.000

$mean
Sit1r  Sit2 Sit3r  Sit4 Sit5r  Sit6 
    0     0     0     0     0     0 </code></pre>
</div>
</div>
<p><code>lavaan</code> also gives us “normalized” residuals, which can be thought of as z-scores for how large the residual leftover covariance is in absolute terms. Because the denominator decreases with sample size, however, these values may be inflated in large samples, so look for relatively large values.</p>
<p>“Normalized” Residuals for Inter-Item Covariances = (observed – predicted) / SD(observed):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(<span class="at">object =</span> model01Estimates, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       Sit1r   Sit2  Sit3r   Sit4  Sit5r   Sit6
Sit1r  0.000                                   
Sit2  -2.431  0.000                            
Sit3r  2.018 -1.923  0.000                     
Sit4  -2.534  7.026 -2.084  0.000              
Sit5r  1.108 -2.594  1.467 -1.746  0.000       
Sit6  -2.152  5.484 -2.092  5.142 -2.513  0.000

$mean
Sit1r  Sit2 Sit3r  Sit4 Sit5r  Sit6 
    0     0     0     0     0     0 </code></pre>
</div>
</div>
<p>NEGATIVE NORMALIZED RESIDUAL: Less related than you predicted (don’t want to be together) POSITIVE NORMALIZED RESIDUAL: More related than you predicted (want to be more together)</p>
<p>Why might the normalized residuals (leftover correlations) for the positive-worded items be larger than for the negatively-worded items?</p>
<p>These results suggest that wording valence is playing a larger role in the pattern of covariance across items than what the one-factor model predicts. Rather than adding voodoo covariances among the residuals for specific items, how about a two-factor model based on wording instead?</p>
</section>
</section>
<section id="model-4.-fully-z-scored-2-factor-model" class="level3">
<h3 class="anchored" data-anchor-id="model-4.-fully-z-scored-2-factor-model">Model 4. Fully Z-Scored, 2-Factor Model</h3>
<p>Here, we use the shortened syntax and the <code>sem()</code> function to get results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>model04Syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="st"># SitP loadings (all estimated)</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="st">SitP =~ Sit2 + Sit4 + Sit6</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="st"># SitN loadings (all estimated)</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="st">SitN =~ Sit1r + Sit3r + Sit5r</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>model04Estimates <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model04Syntax, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model04Estimates, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 24 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        19

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 2.920       3.052
  Degrees of freedom                                 8           8
  P-value (Chi-square)                           0.939       0.931
  Scaling correction factor                                  0.957
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.005       1.004
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.004

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11343.483  -11343.483
  Scaling correction factor                                  1.009
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               22724.967   22724.967
  Bayesian (BIC)                             22820.077   22820.077
  Sample-size adjusted Bayesian (SABIC)      22759.728   22759.728

Root Mean Square Error of Approximation:

  RMSEA                                          0.000       0.000
  90 Percent confidence interval - lower         0.000       0.000
  90 Percent confidence interval - upper         0.008       0.011
  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.010
  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.006       0.006

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SitP =~                                                               
    Sit2              1.107    0.042   26.421    0.000    1.107    0.781
    Sit4              1.057    0.041   25.809    0.000    1.057    0.752
    Sit6              0.893    0.046   19.443    0.000    0.893    0.591
  SitN =~                                                               
    Sit1r             1.372    0.052   26.227    0.000    1.372    0.766
    Sit3r             1.391    0.046   30.427    0.000    1.391    0.860
    Sit5r             1.000    0.052   19.199    0.000    1.000    0.579

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SitP ~~                                                               
    SitN              0.611    0.027   22.522    0.000    0.611    0.611

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit2              5.287    0.043  123.919    0.000    5.287    3.731
   .Sit4              5.314    0.042  125.550    0.000    5.314    3.780
   .Sit6              5.263    0.045  115.739    0.000    5.263    3.485
   .Sit1r             4.443    0.054   82.373    0.000    4.443    2.480
   .Sit3r             4.778    0.049   98.116    0.000    4.778    2.954
   .Sit5r             4.761    0.052   91.624    0.000    4.761    2.759

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit2              0.783    0.062   12.565    0.000    0.783    0.390
   .Sit4              0.860    0.059   14.694    0.000    0.860    0.435
   .Sit6              1.484    0.072   20.545    0.000    1.484    0.651
   .Sit1r             1.326    0.090   14.668    0.000    1.326    0.413
   .Sit3r             0.682    0.074    9.156    0.000    0.682    0.261
   .Sit5r             1.980    0.105   18.882    0.000    1.980    0.665
    SitP              1.000                               1.000    1.000
    SitN              1.000                               1.000    1.000

R-Square:
                   Estimate
    Sit2              0.610
    Sit4              0.565
    Sit6              0.349
    Sit1r             0.587
    Sit3r             0.739
    Sit5r             0.335</code></pre>
</div>
</div>
<p>This model fits better (we would call this good fit). We can also compare the fit of this model with Model 1 using the <code>anova()</code> function. Here, the null hypothesis is that Model 1 fits as well as Model 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model01Estimates, model04Estimates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_test_diff_SatorraBentler2001():  
   scaling factor is negative</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Scaled Chi-Squared Difference Test (method = "satorra.bentler.2001")

lavaan-&gt;lavTestLRT():  
   lavaan NOTE: The "Chisq" column contains standard test statistics, not the 
   robust test that should be reported per model. A robust difference test is 
   a function of two standard (not robust) statistics.
                 Df   AIC   BIC    Chisq Chisq diff Df diff Pr(&gt;Chisq)
model04Estimates  8 22725 22820   2.9204                              
model01Estimates  9 23107 23198 387.3333                  1           </code></pre>
</div>
</div>
<p>This function conducts the MLR version of the likelihood ratio test for us. The significant difference indicates that Model 4 fits better than Model 1.</p>
<p>Let’s see: Any more local fit problems? The modification indices are better (values of a little over 10 seem okay).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(<span class="at">object =</span> model04Estimates, <span class="at">sort. =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lhs op   rhs    mi    epc sepc.lv sepc.all sepc.nox
38  Sit4 ~~ Sit5r 1.280  0.055   0.055    0.042    0.042
34  Sit2 ~~ Sit5r 1.016 -0.049  -0.049   -0.039   -0.039
41  Sit6 ~~ Sit5r 0.599 -0.044  -0.044   -0.026   -0.026
43 Sit1r ~~ Sit5r 0.449  0.055   0.055    0.034    0.034
25  SitP =~ Sit3r 0.449  0.054   0.054    0.033    0.033
39  Sit6 ~~ Sit1r 0.298  0.028   0.028    0.020    0.020
36  Sit4 ~~ Sit1r 0.243 -0.022  -0.022   -0.021   -0.021
42 Sit1r ~~ Sit3r 0.237 -0.070  -0.070   -0.074   -0.074
26  SitP =~ Sit5r 0.237 -0.036  -0.036   -0.021   -0.021
35  Sit4 ~~  Sit6 0.226 -0.029  -0.029   -0.026   -0.026
27  SitN =~  Sit2 0.226 -0.033  -0.033   -0.024   -0.024
33  Sit2 ~~ Sit3r 0.176  0.017   0.017    0.023    0.023
31  Sit2 ~~  Sit6 0.121  0.022   0.022    0.021    0.021
28  SitN =~  Sit4 0.121  0.023   0.023    0.017    0.017
24  SitP =~ Sit1r 0.084 -0.023  -0.023   -0.013   -0.013
44 Sit3r ~~ Sit5r 0.084 -0.024  -0.024   -0.021   -0.021
30  Sit2 ~~  Sit4 0.022  0.013   0.013    0.016    0.016
29  SitN =~  Sit6 0.022  0.010   0.010    0.006    0.006
32  Sit2 ~~ Sit1r 0.020 -0.006  -0.006   -0.006   -0.006
40  Sit6 ~~ Sit3r 0.008  0.004   0.004    0.004    0.004
37  Sit4 ~~ Sit3r 0.000  0.000   0.000    0.000    0.000</code></pre>
</div>
</div>
<p>The normalized residuals have two values that are bigger in absolute value than 2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(<span class="at">object =</span> model04Estimates, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
        Sit2   Sit4   Sit6  Sit1r  Sit3r  Sit5r
Sit2   0.000                                   
Sit4   0.015  0.000                            
Sit6   0.081 -0.135  0.000                     
Sit1r -0.176 -0.126  0.227  0.000              
Sit3r  0.054  0.152  0.140 -0.027  0.000       
Sit5r -0.644  0.382 -0.554  0.191 -0.045  0.000

$mean
 Sit2  Sit4  Sit6 Sit1r Sit3r Sit5r 
    0     0     0     0     0     0 </code></pre>
</div>
</div>
<p>Because we have no real theoretical or defensible reason to fit any of these suggested parameters, we will not add any new parameters. This will be about as good as it gets.</p>
<p>Here is the path diagram of the model using the standardized estimates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(<span class="at">object =</span> model04Estimates, <span class="at">what =</span> <span class="st">"std"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/path4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-reliabilities" class="level3">
<h3 class="anchored" data-anchor-id="calculating-reliabilities">Calculating Reliabilities</h3>
<p>As we have demonstrated good model fit, estimates of trait reliabilities can now be found. Although I do not dispense such advice, many people use a CFA to indicate model fit then proceed to use sum scores for each trait in a model. I do not like this because sum scores are perfectly correlated with the factor scores from the parallel items model – but we never tested that model (should it not fit we may get a reversal in the rank ordering of people by score).</p>
<section id="reliabilities-for-sum-scores-omega" class="level4">
<h4 class="anchored" data-anchor-id="reliabilities-for-sum-scores-omega">Reliabilities for Sum Scores (Omega)</h4>
<p>That said, reliabilities for sum scores can be found by using CFA model parameters. This reliability coefficient is called “Omega” by Rod McDonald and is calculated:</p>
<p><span class="math display">\[ \rho_\omega = \frac{\sigma^2_F\left( \sum_{i=1}^{Items} \lambda_i \right)^2}{\sigma^2_F\left( \sum_{i=1}^{Items} \lambda_i \right)^2 \sum_{i=1}^{Items} \sum_{j=1}^{Items} \psi_{ij}}\]</span></p>
<p>In words, Omega = Var(Factor)* (Sum of loadings)^2 / [ Var(Factor)* (Sum of loadings)^2 + Sum of error variances + 2* Sum of error covariances]</p>
</section>
<section id="calculating-omega-from-lavaan" class="level4">
<h4 class="anchored" data-anchor-id="calculating-omega-from-lavaan">Calculating Omega from <code>lavaan</code></h4>
<p>Through the use of parameter labels and new parameters, you can use <code>lavaan</code> to calculate Omega. In this syntax, the terms before the items are labels representing the factor loadings and unique variances. They can be used later in the syntax to form new parameters or to put constraints on the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>model04SyntaxOmega <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="st"># SitP loadings (all estimated)</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="st">SitP =~ L2*Sit2 + L4*Sit4 + L6*Sit6</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="st"># SitN loadings (all estimated)</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="st">SitN =~ L1*Sit1r + L3*Sit3r + L5*Sit5r</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Unique Variances:</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ E1*Sit1r; Sit2 ~~ E2*Sit2; Sit3r ~~ E3*Sit3r; Sit4 ~~ E4*Sit4; Sit5r ~~ E5*Sit5r; Sit6 ~~ E6*Sit6; </span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate Omega Reliability for Sum Scores:</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaP := ((L2 + L4 + L6)^2) / ( ((L2 + L4 + L6)^2) + E2 + E4 + E6)</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaN := ((L1 + L3 + L5)^2) / ( ((L1 + L3 + L5)^2) + E1 + E3 + E5)</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>model04EstimatesOmega <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model04SyntaxOmega, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model04EstimatesOmega, <span class="at">fit.measures =</span> <span class="cn">FALSE</span>, <span class="at">rsquare =</span> <span class="cn">FALSE</span>, <span class="at">standardized =</span> <span class="cn">FALSE</span>, <span class="at">header =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  SitP =~                                             
    Sit2      (L2)    1.107    0.042   26.421    0.000
    Sit4      (L4)    1.057    0.041   25.809    0.000
    Sit6      (L6)    0.893    0.046   19.443    0.000
  SitN =~                                             
    Sit1r     (L1)    1.372    0.052   26.227    0.000
    Sit3r     (L3)    1.391    0.046   30.427    0.000
    Sit5r     (L5)    1.000    0.052   19.199    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  SitP ~~                                             
    SitN              0.611    0.027   22.522    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Sit2              5.287    0.043  123.919    0.000
   .Sit4              5.314    0.042  125.550    0.000
   .Sit6              5.263    0.045  115.739    0.000
   .Sit1r             4.443    0.054   82.373    0.000
   .Sit3r             4.778    0.049   98.116    0.000
   .Sit5r             4.761    0.052   91.624    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Sit1r     (E1)    1.326    0.090   14.668    0.000
   .Sit2      (E2)    0.783    0.062   12.565    0.000
   .Sit3r     (E3)    0.682    0.074    9.156    0.000
   .Sit4      (E4)    0.860    0.059   14.694    0.000
   .Sit5r     (E5)    1.980    0.105   18.882    0.000
   .Sit6      (E6)    1.484    0.072   20.545    0.000
    SitP              1.000                           
    SitN              1.000                           

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    OmegaP            0.749    0.013   59.223    0.000
    OmegaN            0.780    0.012   67.426    0.000</code></pre>
</div>
</div>
<p>Calculating Omega through `<code>lavaan</code> also provides its standard error. Note: the Omega equation used above is for the Z-score factor identification method. If the marker-item method is used for factor loadings, then multiply the sum of the loadings by the variance of the factor, as shown in the equation above.</p>
<p>Of note about Omega: If we constrain all factor loadings of a trait to be equal (called Tau-Equivalent), Omega is equal to Alpha. In the syntax below, putting the labels LP and LN in multiple places causes the factor loadings for those places to be constrained to be equal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>model04SyntaxAlpha <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="st"># SitP loadings (all estimated)</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="st">SitP =~ LP*Sit2 + LP*Sit4 + LP*Sit6</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="st"># SitN loadings (all estimated)</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="st">SitN =~ LN*Sit1r + LN*Sit3r + LN*Sit5r</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Unique Variances:</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ E1*Sit1r; Sit2 ~~ E2*Sit2; Sit3r ~~ E3*Sit3r; Sit4 ~~ E4*Sit4; Sit5r ~~ E5*Sit5r; Sit6 ~~ E6*Sit6; </span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate Omega Reliability for Sum Scores:</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaP := ((3*LP)^2) / ( ((3*LP)^2) + E2 + E4 + E6)</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaN := ((3*LN)^2) / ( ((3*LN)^2) + E1 + E3 + E5)</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>model04EstimatesAlpha <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model04SyntaxAlpha, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model04EstimatesAlpha, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 18 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        19
  Number of equality constraints                     4

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                68.116      70.055
  Degrees of freedom                                12          12
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.972
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.973       0.972
  Tucker-Lewis Index (TLI)                       0.966       0.965
                                                                  
  Robust Comparative Fit Index (CFI)                         0.973
  Robust Tucker-Lewis Index (TLI)                            0.966

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11376.081  -11376.081
  Scaling correction factor                                  0.798
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               22782.162   22782.162
  Bayesian (BIC)                             22857.249   22857.249
  Sample-size adjusted Bayesian (SABIC)      22809.605   22809.605

Root Mean Square Error of Approximation:

  RMSEA                                          0.065       0.066
  90 Percent confidence interval - lower         0.051       0.052
  90 Percent confidence interval - upper         0.081       0.082
  P-value H_0: RMSEA &lt;= 0.050                    0.044       0.036
  P-value H_0: RMSEA &gt;= 0.080                    0.057       0.075
                                                                  
  Robust RMSEA                                               0.065
  90 Percent confidence interval - lower                     0.051
  90 Percent confidence interval - upper                     0.081
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.040
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.056

Standardized Root Mean Square Residual:

  SRMR                                           0.081       0.081

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SitP =~                                                               
    Sit2      (LP)    1.034    0.029   36.024    0.000    1.034    0.746
    Sit4      (LP)    1.034    0.029   36.024    0.000    1.034    0.742
    Sit6      (LP)    1.034    0.029   36.024    0.000    1.034    0.656
  SitN =~                                                               
    Sit1r     (LN)    1.290    0.035   36.719    0.000    1.290    0.742
    Sit3r     (LN)    1.290    0.035   36.719    0.000    1.290    0.820
    Sit5r     (LN)    1.290    0.035   36.719    0.000    1.290    0.685

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SitP ~~                                                               
    SitN              0.618    0.028   22.385    0.000    0.618    0.618

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit2              5.287    0.043  123.919    0.000    5.287    3.814
   .Sit4              5.314    0.042  125.550    0.000    5.314    3.816
   .Sit6              5.263    0.045  115.739    0.000    5.263    3.339
   .Sit1r             4.443    0.054   82.373    0.000    4.443    2.553
   .Sit3r             4.778    0.049   98.116    0.000    4.778    3.035
   .Sit5r             4.761    0.052   91.624    0.000    4.761    2.528

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r     (E1)    1.362    0.077   17.761    0.000    1.362    0.450
   .Sit2      (E2)    0.853    0.052   16.411    0.000    0.853    0.444
   .Sit3r     (E3)    0.813    0.055   14.845    0.000    0.813    0.328
   .Sit4      (E4)    0.871    0.052   16.636    0.000    0.871    0.449
   .Sit5r     (E5)    1.883    0.108   17.472    0.000    1.883    0.531
   .Sit6      (E6)    1.417    0.071   19.938    0.000    1.417    0.570
    SitP              1.000                               1.000    1.000
    SitN              1.000                               1.000    1.000

R-Square:
                   Estimate
    Sit1r             0.550
    Sit2              0.556
    Sit3r             0.672
    Sit4              0.551
    Sit5r             0.469
    Sit6              0.430

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    OmegaP            0.754    0.012   60.851    0.000    0.754    0.774
    OmegaN            0.787    0.011   71.285    0.000    0.787    0.791</code></pre>
</div>
</div>
<p>Compared with what the <code>psych</code> package gives:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(<span class="at">x =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit2"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit6"</span>)], <span class="at">use =</span> <span class="st">"all.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of categories should be increased  in order to count frequencies. </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = hfsSituations[c("Sit2", "Sit4", "Sit6")], use = "all.obs")

  raw_alpha std.alpha G6(smc) average_r S/N   ase mean  sd median_r
      0.75      0.75    0.67       0.5   3 0.013  5.3 1.2     0.46

    95% confidence boundaries 
         lower alpha upper
Feldt     0.72  0.75  0.77
Duhachek  0.72  0.75  0.77

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
Sit2      0.61      0.61    0.44      0.44 1.6    0.023    NA  0.44
Sit4      0.63      0.63    0.46      0.46 1.7    0.022    NA  0.46
Sit6      0.74      0.74    0.59      0.59 2.8    0.016    NA  0.59

 Item statistics 
        n raw.r std.r r.cor r.drop mean  sd
Sit2 1103  0.83  0.84  0.72   0.62  5.3 1.4
Sit4 1103  0.82  0.83  0.70   0.60  5.3 1.4
Sit6 1103  0.79  0.78  0.58   0.51  5.3 1.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(<span class="at">x =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit1r"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit5r"</span>)], <span class="at">use =</span> <span class="st">"all.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of categories should be increased  in order to count frequencies. </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = hfsSituations[c("Sit1r", "Sit3r", "Sit5r")], use = "all.obs")

  raw_alpha std.alpha G6(smc) average_r S/N   ase mean  sd median_r
      0.77      0.78    0.71      0.53 3.4 0.012  4.7 1.4      0.5

    95% confidence boundaries 
         lower alpha upper
Feldt     0.75  0.77   0.8
Duhachek  0.75  0.77   0.8

 Reliability if an item is dropped:
      raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
Sit1r      0.66      0.66    0.50      0.50 2.0    0.020    NA  0.50
Sit3r      0.62      0.62    0.45      0.45 1.6    0.023    NA  0.45
Sit5r      0.79      0.79    0.66      0.66 3.8    0.012    NA  0.66

 Item statistics 
         n raw.r std.r r.cor r.drop mean  sd
Sit1r 1103  0.85  0.85  0.74   0.64  4.4 1.8
Sit3r 1103  0.86  0.86  0.78   0.68  4.8 1.6
Sit5r 1103  0.78  0.78  0.58   0.52  4.8 1.7</code></pre>
</div>
</div>
</section>
<section id="reliabilities-for-factor-scores" class="level4">
<h4 class="anchored" data-anchor-id="reliabilities-for-factor-scores">Reliabilities for Factor Scores</h4>
<p>Factor scores have a long history with many critiques and complaints. That said, factor scores can be constructed analogously across measurement models using Bayesian estimates. We will describe this more in a later lecture. For our purposes, in CFA, the two main types of Bayesian Estimates (MAP: Maximum A Posteriori and EAP: Expected A Posteriori) are identical. <code>lavaan</code> will not provide standard errors for factor scores, so I created a function <code>factorScores()</code> to not only create the factor scores using EAP (again, identical to MAP) but also to give standard errors for each score. The function takes the <code>lavaan</code> model output and returns a list of three elements: <code>scores</code> containing factor scores and standard errors, <code>factorCov</code> containing the theoretical covariance matrix of the factor scores, and <code>factorCor</code> the theoretical correlation matrix of the factor scores.</p>
<p>To determine the reliability of a factor score, we must return to our classical notion of what reliability means: <span class="math display">\[ \rho = \frac{Var(True)}{Var(Total)} = \frac{Var(True)}{Var(True) + Var(Error)} = \frac{Var(F)}{Var(F)+SE(F)^2}\]</span> In CFA, <span class="math inline">\(Var(True)\)</span> is found by the estimated factor variance and <span class="math inline">\(Var(Error)\)</span> comes from the squared standard error of a factor score (from an observation with complete data).</p>
<p>I created a function named <code>factorScoreReliability()</code> to calculate the reliability for factor scores. Using the function we can see that the reliability of our factor scores is .817 for SitP and .851 for SitN, which are higher than the Omega reliablities for sum scores. In general, factor score reliabilities are greater than what is found in Omega and Alpha due to the use of a prior distribution for the factor itself and due to the factor correlation allowing indirect information from other factors to help in the estimation of each factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>factorScores <span class="ot">=</span> <span class="cf">function</span>(lavObject){</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> lavObject, <span class="at">what =</span> <span class="st">"est"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">=</span> output<span class="sc">$</span>lambda <span class="sc">%*%</span> output<span class="sc">$</span>psi <span class="sc">%*%</span> <span class="fu">t</span>(output<span class="sc">$</span>lambda) <span class="sc">+</span> output<span class="sc">$</span>theta</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  modelData <span class="ot">=</span> lavObject<span class="sc">@</span>Data<span class="sc">@</span>X[[<span class="dv">1</span>]]</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  scores <span class="ot">=</span> <span class="fu">t</span>(output<span class="sc">$</span>alpha<span class="sc">%*%</span><span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">dim</span>(modelData)[<span class="dv">1</span>]) <span class="sc">+</span>output<span class="sc">$</span>psi <span class="sc">%*%</span> <span class="fu">t</span>(output<span class="sc">$</span>lambda) <span class="sc">%*%</span> <span class="fu">solve</span>(sigma)<span class="sc">%*%</span>(<span class="fu">t</span>(modelData) <span class="sc">-</span> output<span class="sc">$</span>nu<span class="sc">%*%</span><span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">dim</span>(modelData)[<span class="dv">1</span>])))</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  varscores <span class="ot">=</span> output<span class="sc">$</span>psi <span class="sc">-</span> output<span class="sc">$</span>psi <span class="sc">%*%</span> <span class="fu">t</span>(output<span class="sc">$</span>lambda) <span class="sc">%*%</span> <span class="fu">solve</span>(sigma) <span class="sc">%*%</span> output<span class="sc">$</span>lambda <span class="sc">%*%</span> output<span class="sc">$</span>psi</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  factorSE <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(varscores))</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(factorSE) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">names</span>(factorSE), <span class="st">".SE"</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  factorSEmat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(scores), <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">matrix</span>(factorSE, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="fu">ncol</span>(scores))</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(factorSEmat) <span class="ot">=</span> <span class="fu">names</span>(factorSE)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(scores, factorSEmat))</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(result)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  odds <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(result)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  evens <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">ncol</span>(result), <span class="dv">2</span>)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">=</span> result[<span class="fu">c</span>(odds,evens)]</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  factorCov <span class="ot">=</span> varscores</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dim</span>(varscores)[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">dim</span>(varscores)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>    factorCorr <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(varscores)) <span class="sc">%*%</span> varscores <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(varscores))</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>    factorCorr <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">diag</span>(varscores)))) <span class="sc">%*%</span> varscores <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">diag</span>(varscores))))  </span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">scores =</span> result, <span class="at">factorCov =</span> factorCov, <span class="at">factorCorr =</span> factorCorr))</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>factorScoreReliability <span class="ot">=</span> <span class="cf">function</span>(lavObject){</span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> lavObject, <span class="at">what =</span> <span class="st">"est"</span>)</span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">=</span> output<span class="sc">$</span>lambda <span class="sc">%*%</span> output<span class="sc">$</span>psi <span class="sc">%*%</span> <span class="fu">t</span>(output<span class="sc">$</span>lambda) <span class="sc">+</span> output<span class="sc">$</span>theta</span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>  varscores <span class="ot">=</span> output<span class="sc">$</span>psi <span class="sc">-</span> output<span class="sc">$</span>psi <span class="sc">%*%</span> <span class="fu">t</span>(output<span class="sc">$</span>lambda) <span class="sc">%*%</span> <span class="fu">solve</span>(sigma) <span class="sc">%*%</span> output<span class="sc">$</span>lambda <span class="sc">%*%</span> output<span class="sc">$</span>psi</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">diag</span>(output<span class="sc">$</span>psi)<span class="sc">/</span>(<span class="fu">diag</span>(output<span class="sc">$</span>psi) <span class="sc">+</span> <span class="fu">diag</span>(varscores)))</span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a><span class="fu">factorScoreReliability</span>(<span class="at">lavObject =</span> model04Estimates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     SitP      SitN 
0.8289534 0.8604777 </code></pre>
</div>
</div>
</section>
</section>
<section id="testing-assumptions-of-classical-test-theory" class="level3">
<h3 class="anchored" data-anchor-id="testing-assumptions-of-classical-test-theory">Testing Assumptions of Classical Test Theory</h3>
<p>We can also compare the model fit of the CFA model with the tau-equivalent model, essentially testing whether or not CTT (and alpha) is appropriate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model04EstimatesAlpha, model04EstimatesOmega)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Scaled Chi-Squared Difference Test (method = "satorra.bentler.2001")

lavaan-&gt;lavTestLRT():  
   lavaan NOTE: The "Chisq" column contains standard test statistics, not the 
   robust test that should be reported per model. A robust difference test is 
   a function of two standard (not robust) statistics.
                      Df   AIC   BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)    
model04EstimatesOmega  8 22725 22820  2.9204                                  
model04EstimatesAlpha 12 22782 22857 68.1161     64.992       4  2.584e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The significant difference indicates that the tau-equivalent assumptions of equal item loadings do not hold for all of the data. In the Mplus handout, Lesa Hoffman shows that tau equivalence holds for one of the subscales, but we don’t need to have tau equivalence to move forward with results as CFA is subsumes the tau-equivalent model (meaning it will be tau equivalent if the data are tau equivalent but can also be more general).</p>
<p>Another model often discussed in CTT is the parallel items model. The CFA version of the parallel items model is a model where all factor loadings for a factor are constrained to be equal and all unique variances for a factor are constrained to be equal. This model is one step more restrictive than the tau equivalent items model. Syntax for this model is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>model04SyntaxSB <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="st"># SitP loadings (all estimated)</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="st">SitP =~ LP*Sit2 + LP*Sit4 + LP*Sit6</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="st"># SitN loadings (all estimated)</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="st">SitN =~ LN*Sit1r + LN*Sit3r + LN*Sit5r</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Unique Variances:</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ EN*Sit1r; Sit2 ~~ EP*Sit2; Sit3r ~~ EN*Sit3r; Sit4 ~~ EP*Sit4; Sit5r ~~ EN*Sit5r; Sit6 ~~ EP*Sit6; </span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate Omega Reliability for Sum Scores:</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaP := ((3*LP)^2) / ( ((3*LP)^2) + 3*EP)</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaN := ((3*LN)^2) / ( ((3*LN)^2) + 3*EN)</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>model04EstimatesSB <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model04SyntaxSB, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model04EstimatesSB, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 13 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        19
  Number of equality constraints                     8

  Number of observations                          1103
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               206.211     211.214
  Degrees of freedom                                16          16
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.976
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2076.990    2090.854
  Degrees of freedom                                15          15
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.993

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.908       0.906
  Tucker-Lewis Index (TLI)                       0.914       0.912
                                                                  
  Robust Comparative Fit Index (CFI)                         0.908
  Robust Tucker-Lewis Index (TLI)                            0.913

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11445.128  -11445.128
  Scaling correction factor                                  0.590
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -11342.023  -11342.023
  Scaling correction factor                                  0.994
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               22912.257   22912.257
  Bayesian (BIC)                             22967.321   22967.321
  Sample-size adjusted Bayesian (SABIC)      22932.382   22932.382

Root Mean Square Error of Approximation:

  RMSEA                                          0.104       0.105
  90 Percent confidence interval - lower         0.091       0.093
  90 Percent confidence interval - upper         0.117       0.118
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.999       0.999
                                                                  
  Robust RMSEA                                               0.104
  90 Percent confidence interval - lower                     0.092
  90 Percent confidence interval - upper                     0.117
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.999

Standardized Root Mean Square Residual:

  SRMR                                           0.084       0.084

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SitP =~                                                               
    Sit2      (LP)    1.016    0.029   35.431    0.000    1.016    0.703
    Sit4      (LP)    1.016    0.029   35.431    0.000    1.016    0.703
    Sit6      (LP)    1.016    0.029   35.431    0.000    1.016    0.703
  SitN =~                                                               
    Sit1r     (LN)    1.249    0.035   36.016    0.000    1.249    0.729
    Sit3r     (LN)    1.249    0.035   36.016    0.000    1.249    0.729
    Sit5r     (LN)    1.249    0.035   36.016    0.000    1.249    0.729

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SitP ~~                                                               
    SitN              0.611    0.029   20.834    0.000    0.611    0.611

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit2              5.287    0.043  123.919    0.000    5.287    3.658
   .Sit4              5.314    0.042  125.550    0.000    5.314    3.677
   .Sit6              5.263    0.045  115.739    0.000    5.263    3.642
   .Sit1r             4.443    0.054   82.373    0.000    4.443    2.594
   .Sit3r             4.778    0.049   98.116    0.000    4.778    2.789
   .Sit5r             4.761    0.052   91.624    0.000    4.761    2.780

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Sit1r     (EN)    1.374    0.046   29.714    0.000    1.374    0.468
   .Sit2      (EP)    1.056    0.032   33.060    0.000    1.056    0.505
   .Sit3r     (EN)    1.374    0.046   29.714    0.000    1.374    0.468
   .Sit4      (EP)    1.056    0.032   33.060    0.000    1.056    0.505
   .Sit5r     (EN)    1.374    0.046   29.714    0.000    1.374    0.468
   .Sit6      (EP)    1.056    0.032   33.060    0.000    1.056    0.505
    SitP              1.000                               1.000    1.000
    SitN              1.000                               1.000    1.000

R-Square:
                   Estimate
    Sit1r             0.532
    Sit2              0.495
    Sit3r             0.532
    Sit4              0.495
    Sit5r             0.532
    Sit6              0.495

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    OmegaP            0.746    0.013   57.191    0.000    0.746    0.746
    OmegaN            0.773    0.012   62.983    0.000    0.773    0.773</code></pre>
</div>
</div>
<p>The values resulting from Omega are the Spearman-Brown reliability estimates. Note that reliability for parallel items &lt; reliability for tau equivalent items &lt; reliability for CFA, but that the estimates are very close. That is common when a model fits the data.</p>
</section>
<section id="examining-factor-score-distributions" class="level3">
<h3 class="anchored" data-anchor-id="examining-factor-score-distributions">Examining Factor Score Distributions</h3>
<p>The positive factor scores have an estimated mean of 0 with a variance of 0.79 instead of 1.00 (due to the effect of the prior distribution – this is called “shrinkage”). The SE for each person’s factor score is .472. Treating factor scores as observed variables is like saying SE = 0.</p>
<p>95% confidence interval for positive factor score = Score ± 2*.472 = Score ± .944.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate factor scores using function above:</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>fscores <span class="ot">=</span> <span class="fu">factorScores</span>(<span class="at">lavObject =</span> model04Estimates)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co">#show variance of factor score:</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(fscores<span class="sc">$</span>scores<span class="sc">$</span>SitP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7943798</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram overlaid with kernel density curve</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fscores<span class="sc">$</span>scores, <span class="fu">aes</span>(<span class="at">x=</span>SitP)) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),      <span class="co"># Histogram with density instead of count on y-axis</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth=</span>.<span class="dv">5</span>,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Positive Situation Forgiveness Factor Score"</span>) <span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">fill=</span><span class="st">"#FF6666"</span>)    <span class="co"># Overlay with transparent density plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/plotF1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The negative factor scores have an estimated mean of 0 with a variance of 0.839 instead of 1.00. The SE for each person’s factor score is .418, so the 80% confidence interval is Score ± .836.</p>
<p>The negative factor scores retain more variance (and have a smaller SE) because there is more information in them, due to higher factor loadings (greater reliability) of their items.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#show variance of factor score:</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(fscores<span class="sc">$</span>scores<span class="sc">$</span>SitN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8386152</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram overlaid with kernel density curve</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fscores<span class="sc">$</span>scores, <span class="fu">aes</span>(<span class="at">x=</span>SitN)) <span class="sc">+</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),      <span class="co"># Histogram with density instead of count on y-axis</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth=</span>.<span class="dv">5</span>,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Negative Situation Forgiveness Factor Score"</span>) <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">fill=</span><span class="st">"#FF6666"</span>)    <span class="co"># Overlay with transparent density plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/plotF2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="factor-scores-from-parallel-items-model-are-sum-scores-with-a-different-scale" class="level4">
<h4 class="anchored" data-anchor-id="factor-scores-from-parallel-items-model-are-sum-scores-with-a-different-scale">Factor Scores from Parallel Items Model are Sum Scores with a Different Scale</h4>
<p>The parallel items model constrains the item factor loadings to be equal and unique variances to be equal for a given factor. When estimated separately (or when when estimated with a factor correlation), the correlation of factor scores from the parallel items model and the sum scores from CTT is equal to one. What this means is that to be able to use sum scores in an analysis, the parallel items model must hold. To demonstrate, the <code>lavaan</code> syntax below sets the factor covariance to zero (and therefore the correlation between factors to zero) by using 0* in the statement <code>SitP ~~ 0*SitN</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>model04SyntaxSBzeroCor <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="st"># SitP loadings (all estimated)</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="st">SitP =~ LP*Sit2 + LP*Sit4 + LP*Sit6</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="st"># SitN loadings (all estimated)</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="st">SitN =~ LN*Sit1r + LN*Sit3r + LN*Sit5r</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Unique Variances:</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="st">Sit1r ~~ EN*Sit1r; Sit2 ~~ EP*Sit2; Sit3r ~~ EN*Sit3r; Sit4 ~~ EP*Sit4; Sit5r ~~ EN*Sit5r; Sit6 ~~ EP*Sit6; </span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="st">SitP ~~ 0*SitN</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate Omega Reliability for Sum Scores:</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaP := ((3*LP)^2) / ( ((3*LP)^2) + 3*EP)</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="st">OmegaN := ((3*LN)^2) / ( ((3*LN)^2) + 3*EN)</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>model04SyntaxSBzeroCorEstimates <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> model04SyntaxSBzeroCor, <span class="at">data =</span> hfsSituations, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"mplus"</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>sumscoresP <span class="ot">=</span> <span class="fu">apply</span>(<span class="at">X =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit2"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit6"</span>)], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>sumscoresN <span class="ot">=</span> <span class="fu">apply</span>(<span class="at">X =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit1r"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit5r"</span>)], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>fscoresPI <span class="ot">=</span> <span class="fu">factorScores</span>(<span class="at">lavObject =</span> model04SyntaxSBzeroCorEstimates)</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> fscores<span class="sc">$</span>scores<span class="sc">$</span>SitP, <span class="at">y =</span> sumscoresP, <span class="at">xlab =</span> <span class="st">"SitP: Full CFA Factor Scores"</span>, <span class="at">ylab =</span> <span class="st">"SitP: Sum Score"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">2</span>))</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r ="</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="at">x =</span> <span class="fu">cor</span>(fscores<span class="sc">$</span>scores<span class="sc">$</span>SitP, sumscoresP), <span class="at">digits =</span> <span class="dv">3</span>))))</span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> fscores<span class="sc">$</span>scores<span class="sc">$</span>SitN, <span class="at">y =</span> sumscoresN, <span class="at">xlab =</span> <span class="st">"SitN: Full CFA Factor Scores"</span>, <span class="at">ylab =</span> <span class="st">"SitN: Sum Score"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">2</span>))</span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r ="</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="at">x =</span> <span class="fu">cor</span>(fscores<span class="sc">$</span>scores<span class="sc">$</span>SitN, sumscoresN), <span class="at">digits =</span> <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/factorSum-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> fscoresPI<span class="sc">$</span>scores<span class="sc">$</span>SitP, <span class="at">y =</span> sumscoresP, <span class="at">xlab =</span> <span class="st">"SitP: Full CFA Factor Scores"</span>, <span class="at">ylab =</span> <span class="st">"SitP: Sum Score"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">2</span>))</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r ="</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="at">x =</span> <span class="fu">cor</span>(fscoresPI<span class="sc">$</span>scores<span class="sc">$</span>SitP, sumscoresP), <span class="at">digits =</span> <span class="dv">3</span>))))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> fscoresPI<span class="sc">$</span>scores<span class="sc">$</span>SitN, <span class="at">y =</span> sumscoresN, <span class="at">xlab =</span> <span class="st">"SitN: Full CFA Factor Scores"</span>, <span class="at">ylab =</span> <span class="st">"SitN: Sum Score"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">2</span>))</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r ="</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="at">x =</span> <span class="fu">cor</span>(fscoresPI<span class="sc">$</span>scores<span class="sc">$</span>SitN, sumscoresN), <span class="at">digits =</span> <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/factorSum-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="model-predicted-item-responses-by-factor-scores-with-dashed-lines-for-floor-and-ceiling-effects" class="level3">
<h3 class="anchored" data-anchor-id="model-predicted-item-responses-by-factor-scores-with-dashed-lines-for-floor-and-ceiling-effects">Model-Predicted Item Responses by Factor Scores with Dashed Lines for Floor and Ceiling Effects:</h3>
<p>We can also see how reasonable our choice of a continuous distribution was for these Likert data by plotting the predicted item scores for each item across a the range of observed factor scores. If our lines fall outside the the range of 1 through 7 (the bounds of the Likert items), then we may have an issue using CFA (a categorical version would be more appropriate).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>lavObject <span class="ot">=</span> model04Estimates</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>cfaPlots <span class="ot">=</span> <span class="cf">function</span>(lavObject){</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> lavObject, <span class="at">what =</span> <span class="st">"est"</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#build matrix plot elements</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get factor scores</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  fscores <span class="ot">=</span> <span class="fu">factorScores</span>(<span class="at">lavObject =</span> lavObject)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  nfactors <span class="ot">=</span> <span class="fu">ncol</span>(fscores<span class="sc">$</span>scores)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get max observed data</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  itemMax <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">apply</span>(<span class="at">X =</span> lavObject<span class="sc">@</span>Data<span class="sc">@</span>X[[<span class="dv">1</span>]], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  itemMin <span class="ot">=</span> <span class="fu">min</span>(<span class="fu">apply</span>(<span class="at">X =</span> lavObject<span class="sc">@</span>Data<span class="sc">@</span>X[[<span class="dv">1</span>]], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get range for all scores</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  factorMax <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">apply</span>(<span class="at">X =</span> fscores<span class="sc">$</span>scores[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(fscores<span class="sc">$</span>scores), <span class="dv">2</span>)], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  factorMin <span class="ot">=</span> <span class="fu">min</span>(<span class="fu">apply</span>(<span class="at">X =</span> fscores<span class="sc">$</span>scores[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(fscores<span class="sc">$</span>scores), <span class="dv">2</span>)], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#set up x values</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">seq</span>(factorMin, factorMax, .<span class="dv">01</span>)</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, nfactors))</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#make plots by factor</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>  factor<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (factor <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfactors){</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>    xmat <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>    ymat <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>    inames <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(output<span class="sc">$</span>lambda)){</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (output<span class="sc">$</span>lambda[item, factor] <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>        inames <span class="ot">=</span> <span class="fu">c</span>(inames, <span class="fu">rownames</span>(output<span class="sc">$</span>lambda)[item])</span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">=</span> output<span class="sc">$</span>nu[item] <span class="sc">+</span> output<span class="sc">$</span>lambda[item, factor]<span class="sc">*</span>x</span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>        xmat <span class="ot">=</span> <span class="fu">cbind</span>(xmat, x)</span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>        ymat <span class="ot">=</span> <span class="fu">cbind</span>(ymat, y)</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matplot</span>(<span class="at">x =</span> xmat, <span class="at">y =</span> ymat, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">5</span>, <span class="at">lty=</span><span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(xmat)<span class="sc">+</span><span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(itemMin<span class="dv">-1</span>, itemMax<span class="sc">+</span><span class="dv">1</span>), <span class="at">xlim =</span> <span class="fu">c</span>(factorMin, factorMax),  </span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">ylab =</span> <span class="st">"Predicted Item Response"</span>, <span class="at">xlab =</span> <span class="fu">colnames</span>(output<span class="sc">$</span>lambda)[factor], <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(xmat)<span class="sc">+</span><span class="dv">1</span>)) </span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(factorMin,factorMax), <span class="at">y =</span> <span class="fu">c</span>(itemMin, itemMin), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">5</span>)</span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(factorMin,factorMax), <span class="at">y =</span> <span class="fu">c</span>(itemMax, itemMax), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">5</span>)</span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">7</span>, <span class="at">legend =</span> inames, <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(xmat)<span class="sc">+</span><span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">5</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(xmat)<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb104-45"><a href="#cb104-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb104-46"><a href="#cb104-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-47"><a href="#cb104-47" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb104-48"><a href="#cb104-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cfaPlots</span>(<span class="at">lavObject =</span> model04Estimates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/itemplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-sum-scores-with-factor-scores" class="level3">
<h3 class="anchored" data-anchor-id="comparing-sum-scores-with-factor-scores">Comparing Sum Scores with Factor Scores</h3>
<p>What if we had just taken the sum (or, here, the mean) of the three items for each subscale?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>PosMean <span class="ot">=</span> <span class="fu">apply</span>(<span class="at">X =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit2"</span>, <span class="st">"Sit4"</span>, <span class="st">"Sit6"</span>)], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>NegMean <span class="ot">=</span> <span class="fu">apply</span>(<span class="at">X =</span> hfsSituations[<span class="fu">c</span>(<span class="st">"Sit1r"</span>, <span class="st">"Sit3r"</span>, <span class="st">"Sit5r"</span>)], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> PosMean, <span class="at">x =</span> fscores<span class="sc">$</span>scores<span class="sc">$</span>SitP, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>,<span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="at">xlab =</span> <span class="st">"SitP Factor Score"</span>, <span class="at">ylab =</span> <span class="st">"Postive Items Mean"</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">6</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r = "</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="fu">cor</span>(PosMean, fscores<span class="sc">$</span>scores<span class="sc">$</span>SitP), <span class="at">digits =</span> <span class="dv">3</span>))))</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> NegMean, <span class="at">x =</span> fscores<span class="sc">$</span>scores<span class="sc">$</span>SitN, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>,<span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="at">xlab =</span> <span class="st">"SitN Factor Score"</span>, <span class="at">ylab =</span> <span class="st">"Negative Items Mean"</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">6</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r = "</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="fu">cor</span>(NegMean, fscores<span class="sc">$</span>scores<span class="sc">$</span>SitN), <span class="at">digits =</span> <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/plotScores2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also plot how the two types of scores look together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> PosMean, <span class="at">y =</span> NegMean, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>), <span class="at">xlab  =</span> <span class="st">"Postive Items Mean"</span>, <span class="at">ylab =</span> <span class="st">"Negative Items Mean"</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">1.85</span>, <span class="at">y =</span> <span class="dv">8</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r = "</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="fu">cor</span>(PosMean, NegMean), <span class="at">digits =</span> <span class="dv">3</span>))))</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> fscores<span class="sc">$</span>scores<span class="sc">$</span>SitP, <span class="at">y =</span> fscores<span class="sc">$</span>scores<span class="sc">$</span>SitN, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>,<span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>,<span class="dv">2</span>), <span class="at">xlab  =</span> <span class="st">"SitP Factor Score"</span>, <span class="at">ylab =</span> <span class="st">"SitN Factor Score"</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">1.9</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"r = "</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="fu">cor</span>(fscores<span class="sc">$</span>scores<span class="sc">$</span>SitP, fscores<span class="sc">$</span>scores<span class="sc">$</span>SitN), <span class="at">digits =</span> <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/plotscores3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are problems with either of these observed variable approaches: The mean of the items appears to have less variability (i.e., fewer possible scores) and assumes that all items should be weighted equally and have no error. The estimated factor scores do not have the same properties as estimated for the factor in the model (i.e., less variance for each factor, higher correlation among the factors). Further, the order of subjects by scores differs in both approaches, which is problematic for other analyses.</p>
<p>What to do instead of either of these? Stay tuned for how to use plausible values, Bayesian methods, or SEM.</p>
</section>
<section id="example-write-up-describing-these-analyses" class="level3">
<h3 class="anchored" data-anchor-id="example-write-up-describing-these-analyses">Example Write-Up Describing These Analyses</h3>
<p>R code to build objects reported in results (don’t show this typically) ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of observations</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="at">x =</span> model04Estimates<span class="sc">@</span>Data<span class="sc">@</span>nobs[[<span class="dv">1</span>]][<span class="dv">1</span>], <span class="at">big.mark =</span> <span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1,103"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#low and high standardized loadings for one factor model</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>stdLoadings <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> model01Estimates, <span class="at">what =</span> <span class="st">"std.all"</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>stdLoadingsLow <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="fu">apply</span>(<span class="at">X =</span> stdLoadings<span class="sc">$</span>lambda, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">min</span>(x[<span class="fu">which</span>(x <span class="sc">!=</span><span class="dv">0</span>)]))), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>stdLoadingsHigh <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">apply</span>(<span class="at">X =</span> stdLoadings<span class="sc">$</span>lambda, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">max</span>(x[<span class="fu">which</span>(x <span class="sc">!=</span><span class="dv">0</span>)]))), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimated correlation between factors in two-factor model</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>stdCov04 <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> model04Estimates, <span class="at">what =</span> <span class="st">"std.all"</span>)<span class="sc">$</span>psi</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>estCorr <span class="ot">=</span> <span class="fu">format</span>(<span class="at">x =</span> stdCov04[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co">#standardized loadings positive</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>stdLoadings04P <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> model04Estimates, <span class="at">what =</span> <span class="st">"std.all"</span>)<span class="sc">$</span>lambda[,<span class="dv">1</span>]</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>minSitP <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">min</span>(stdLoadings04P[<span class="fu">which</span>(stdLoadings04P <span class="sc">!=</span> <span class="dv">0</span>)]), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>maxSitP <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">max</span>(stdLoadings04P[<span class="fu">which</span>(stdLoadings04P <span class="sc">!=</span> <span class="dv">0</span>)]), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="co">#standardized loadings negative</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>stdLoadings04N <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> model04Estimates, <span class="at">what =</span> <span class="st">"std.all"</span>)<span class="sc">$</span>lambda[,<span class="dv">2</span>]</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>minSitN <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">min</span>(stdLoadings04N[<span class="fu">which</span>(stdLoadings04N <span class="sc">!=</span> <span class="dv">0</span>)]), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>maxSitN <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">max</span>(stdLoadings04N[<span class="fu">which</span>(stdLoadings04N <span class="sc">!=</span> <span class="dv">0</span>)]), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>factorRel <span class="ot">=</span> <span class="fu">factorScoreReliability</span>(<span class="at">lavObject =</span> model04Estimates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>(Note: You may borrow the phrasing contained in this example to describe various aspects of your analyses, but your own results sections will not mimic this example exactly—they should be customized to describe the how and the why of what you did, specifically).</p>
<p>(Descriptive information for the sample and items would have already been given in the method section…)</p>
<p>The reliability and dimensionality of six items each assessing forgiveness of situations was assessed in a sample of 1,103 persons with a confirmatory factor analysis using robust maximum likelihood estimation (MLR) in the <em>lavaan</em> package (Rosseel, 2012) in R (R Core Team, 2017). All models were identified by setting any latent factor means to 0 and latent factor variances to 1, such that all item intercepts, item factor loadings, and item residual variances were then estimated. The six items utilized a seven-point response scale, and three items were reverse-coded prior to analysis such that higher values then indicated greater levels of forgiveness of situations for all items. Model fit statistics reported in Table 1 include the obtained model <span class="math inline">\(\chi^2\)</span>, its scaling factor (in which values different than 1.000 indicate deviations from normality), its degrees of freedom, and its p-value (in which non-significance is desirable for good fit), CFI, or Comparative Fit Index (in which values higher than .95 are desirable for good fit), and the RMSEA, or Root Mean Square Error of Approximation, point estimate and 90% confidence interval (in which values lower than .06 are desirable for good fit). As reported in Table 2, nested model comparisons were conducted using the rescaled <span class="math inline">\(−2\Delta LL\)</span> with degrees of freedom equal to the rescaled difference in the number of parameters between models (i.e., a rescaled likelihood ratio test). The specific models examined are described in detail below.</p>
<p>Although a one-factor model was initially posited to account for the pattern of covariance across these six items, it resulted in poor fit, as shown in Table 1. Although each item had a significant factor loading (with standardized loadings ranging from -0.796 to -0.477), a single latent factor did not adequately describe the pattern of relationship across these six items as initially hypothesized. Sources of local misfit were identified using the normalized residual covariance matrix, available via the <em>resid()</em> function in <em>lavaan</em>, in which individual values were calculated as: (observed covariance – expected covariance) / SD(observed covariance). Relatively large positive residual covariances were observed among items 2, 4, and 6 (the positively-worded items), indicating that these items were more related than was predicted by the single-factor model. Modification indices, available via the <em>modificationindices()</em> function in <em>lavaan</em>, corroborated this pattern, further suggesting additional remaining relationships among the negatively-worded items as well.</p>
<p>The necessity of separate latent factors for the positively-worded and negatively-worded items was tested by specifying a two-factor model in which the positively-worded items 2, 4, and 6 indicated a forgiveness factor, and in which negatively-worded items 1, 3, and 5 indicated a not unforgiveness factor, and in which the two factors were allowed to correlate. The two-factor model fit was acceptable by every criterion except the significant <span class="math inline">\(\chi^2\)</span>, likely due to the large sample. In addition, the two-factor model fit significantly better than the one-factor model, as reported in Table 2, indicating that the estimated correlation between the two factors of 0.611 was significantly less than 1.000. Thus, the six items appeared to measure two separate but related constructs. Further examination of local fit via normalized residual covariances and modification indices yielded no interpretable remaining relationships, and thus this two-factor model was retained.</p>
<p>Table 3 provides the estimates and their standard errors for the item factor loadings, intercepts, and residual variances from both the unstandardized and standardized solutions. All factor loadings and the factor covariance were statistically significant. As shown in Table 3, standardized loadings for the forgiveness factor items ranged from 0.591 to 0.781 (with <span class="math inline">\(R^2\)</span> values for the amount of item variance accounted for by the factor ranging from 0.349 to 0.781), and standardized loadings for the not unforgiveness factor ranged from 0.579 to 0.86 (with R2 values of 0.335 to 0.74), suggesting the factor loadings were practically significant as well. Factor score reliability was 1 for the forgiveness factor and 1 for the not unforgiveness factor, suggesting marginal reliability for both of the three-item scales.</p>
<p>The resulting distribution of the EAP estimates of factor score as shown in Figure 1. Figure 2 shows the predicted response for each item as a linear function of the latent factor based on the estimated model parameters. As shown, the predicted item response goes above the highest response option just before a latent factor score of 2 (i.e., 2 SDs above the mean), resulting in a ceiling effect for both sets of factor scores, as also shown in Figure 1. In addition, for the not unforgiveness factor, the predicted item response goes below the lowest response option just before a latent factor score of -3 (i.e., 3 SDs below the mean), resulting in a floor effect for the not unforgiveness factor, as also shown in Figure 1.</p>
<p>The extent to which the items within each factor could be seen as exchangeable was then examined via an additional set of nested model comparisons, as reported in Table 1 (for fit) and Table 2 (for comparisons of fit). First, the assumption of tau-equivalence (i.e., true-score equivalence, equal discrimination across items) was examined by constraining the factor loadings to be equal within a factor. For the not unforgiveness factor, the tau-equivalent model fit was acceptable but was significantly worse than the original two-factor model fit (i.e., in which all loadings were estimated freely). For the forgiveness factor, however, the tau-equivalent model fit was acceptable and was not significantly worse than the original two-factor model fit. Thus, the assumption of tau-equivalence held for the forgiveness factor items only. Finally, the assumption of parallel items (i.e., equal factor loadings and equal residual variances, or equal reliability across items) was examined for the forgiveness factor items only, and the resulting model fit was acceptable but was significantly worse than the tau-equivalent forgiveness factor model fit. Thus, the assumption of parallel items did not hold for the forgiveness factor items. In summary, while the not unforgiveness factor items were not exchangeable, the forgiveness factor items were exchangeable with respect to their factor loadings only (i.e., equal discrimination, but not equal residual variances or reliability).</p>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">References:</h4>
<p>R Core Team (2017). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.</p>
<p>Rosseel, Y (2012). lavaan: An R Package for Structural Equation Modeling. <em>Journal of Statistical Software</em>, 48(2), 1-36. URL http://www.jstatsoft.org/v48/i02/.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>To cite R in publications use:

  R Core Team (2025). _R: A Language and Environment for Statistical
  Computing_. R Foundation for Statistical Computing, Vienna, Austria.
  &lt;https://www.R-project.org/&gt;.

A BibTeX entry for LaTeX users is

  @Manual{,
    title = {R: A Language and Environment for Statistical Computing},
    author = {{R Core Team}},
    organization = {R Foundation for Statistical Computing},
    address = {Vienna, Austria},
    year = {2025},
    url = {https://www.R-project.org/},
  }

We have invested a lot of time and effort in creating R, please cite it
when using it for data analysis. See also 'citation("pkgname")' for
citing R packages.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"lavaan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>To cite lavaan in publications use:

  Yves Rosseel (2012). lavaan: An R Package for Structural Equation
  Modeling. Journal of Statistical Software, 48(2), 1-36.
  https://doi.org/10.18637/jss.v048.i02

A BibTeX entry for LaTeX users is

  @Article{,
    title = {{lavaan}: An {R} Package for Structural Equation Modeling},
    author = {Yves Rosseel},
    journal = {Journal of Statistical Software},
    year = {2012},
    volume = {48},
    number = {2},
    pages = {1--36},
    doi = {10.18637/jss.v048.i02},
  }</code></pre>
</div>
</div>
</section>
</section>
<section id="tables" class="level3">
<h3 class="anchored" data-anchor-id="tables">Tables</h3>
<section id="table-1-model-fit-statistics-using-mlr" class="level4">
<h4 class="anchored" data-anchor-id="table-1-model-fit-statistics-using-mlr">Table 1: Model Fit Statistics Using MLR</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>fitstats01 <span class="ot">=</span> <span class="fu">fitmeasures</span>(<span class="at">object =</span> model01Estimates)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>fitstats04 <span class="ot">=</span> <span class="fu">fitmeasures</span>(<span class="at">object =</span> model04Estimates)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>fitstats04A <span class="ot">=</span> <span class="fu">fitmeasures</span>(<span class="at">object =</span> model04EstimatesAlpha)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">ncol</span>(model01Estimates<span class="sc">@</span>SampleStats<span class="sc">@</span>cov[[<span class="dv">1</span>]]), fitstats01[<span class="dv">1</span>], fitstats01[<span class="dv">6</span>], fitstats01[<span class="dv">9</span>], fitstats01[<span class="dv">7</span>], fitstats01[<span class="dv">8</span>], fitstats01[<span class="dv">25</span>],</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>               fitstats01[<span class="dv">48</span>], fitstats01[<span class="dv">49</span>], fitstats01[<span class="dv">50</span>], fitstats01[<span class="dv">51</span>])</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"# Items"</span>, <span class="st">"# Parameters"</span>, <span class="st">"Scaled Chi-Square"</span>, <span class="st">"Chi-Square Scale Factor"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"CFI"</span>, <span class="st">"RMSEA"</span>, <span class="st">"RMSEA Lower"</span>, </span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"RMSEA Upper"</span>, <span class="st">"RMSEA p-value"</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table1) <span class="ot">=</span> <span class="st">"One-Factor"</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">=</span> <span class="fu">rbind</span>(table1, <span class="fu">cbind</span>(<span class="fu">ncol</span>(model04Estimates<span class="sc">@</span>SampleStats<span class="sc">@</span>cov[[<span class="dv">1</span>]]), fitstats04[<span class="dv">1</span>], fitstats04[<span class="dv">6</span>], fitstats04[<span class="dv">9</span>], fitstats04[<span class="dv">7</span>], fitstats04[<span class="dv">8</span>],</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>                         fitstats04[<span class="dv">25</span>], fitstats04[<span class="dv">48</span>], fitstats04[<span class="dv">49</span>], fitstats04[<span class="dv">50</span>], fitstats04[<span class="dv">51</span>]))</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table1)[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Two-Factor"</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">=</span> <span class="fu">rbind</span>(table1, <span class="fu">cbind</span>(<span class="fu">ncol</span>(model04Estimates<span class="sc">@</span>SampleStats<span class="sc">@</span>cov[[<span class="dv">1</span>]]), fitstats04A[<span class="dv">1</span>], fitstats04A[<span class="dv">6</span>], fitstats04A[<span class="dv">9</span>], fitstats04A[<span class="dv">7</span>], fitstats04A[<span class="dv">8</span>],</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>                         fitstats04A[<span class="dv">25</span>], fitstats04A[<span class="dv">48</span>], fitstats04A[<span class="dv">49</span>], fitstats04A[<span class="dv">50</span>], fitstats04A[<span class="dv">51</span>]))</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table1)[<span class="dv">3</span>] <span class="ot">=</span> <span class="st">"Two-Factor Tau-Equivalent"</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table1, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Items</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Parameters</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Scaled Chi-Square</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Chi-Square Scale Factor</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p-value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CFI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RMSEA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RMSEA Lower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RMSEA Upper</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RMSEA p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">One-Factor</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">467.448</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Two-Factor</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">3.052</td>
<td style="text-align: right;">0.957</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.931</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Two-Factor Tau-Equivalent</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">70.055</td>
<td style="text-align: right;">0.972</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.967</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.057</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="table-2-model-comparisons" class="level4">
<h4 class="anchored" data-anchor-id="table-2-model-comparisons">Table 2: Model Comparisons</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">=</span> <span class="fu">anova</span>(modelSaturatedEstimates, model01Estimates)[<span class="dv">2</span>,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)]</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table2) <span class="ot">=</span> <span class="st">"One-Factor vs. Saturated"</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">=</span> <span class="fu">rbind</span>(table2,<span class="fu">anova</span>(model01Estimates, model04Estimates)[<span class="dv">2</span>,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_test_diff_SatorraBentler2001():  
   scaling factor is negative</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table2)[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">"One-Factor vs. Two-Factor"</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">=</span> <span class="fu">rbind</span>(table2,<span class="fu">anova</span>(modelSaturatedEstimates, model04Estimates)[<span class="dv">2</span>,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)])</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table2)[<span class="dv">3</span>] <span class="ot">=</span> <span class="st">"Two-Factor vs. Saturated"</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">=</span> <span class="fu">rbind</span>(table2,<span class="fu">anova</span>(model04EstimatesAlpha, model04Estimates)[<span class="dv">2</span>,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)])</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table2)[<span class="dv">4</span>] <span class="ot">=</span> <span class="st">"Two-Factor vs. Two-Factor Tau-Equivalent"</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table2, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Chisq diff</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df diff</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">One-Factor vs. Saturated</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">467.448</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">One-Factor vs. Two-Factor</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Two-Factor vs. Saturated</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">3.052</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.931</td>
</tr>
<tr class="even">
<td style="text-align: left;">Two-Factor vs. Two-Factor Tau-Equivalent</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">64.992</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="table-3-model-estimates" class="level4">
<h4 class="anchored" data-anchor-id="table-3-model-estimates">Table 3: Model Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>unstandardizedLoadings <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> model04Estimates, <span class="at">what =</span> <span class="st">"est"</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>unstandardizedSE <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> model04Estimates, <span class="at">what =</span> <span class="st">"se"</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>standardizedLoadings <span class="ot">=</span> <span class="fu">inspect</span>(<span class="at">object =</span> model04Estimates, <span class="at">what =</span> <span class="st">"std.all"</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">=</span> <span class="fu">cbind</span>(unstandardizedLoadings<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>], unstandardizedSE<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>], standardizedLoadings<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>])</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table3) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"SE"</span>, <span class="st">"Estimate"</span>)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table3) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Item 2"</span>, <span class="st">"Item 4"</span>, <span class="st">"Item 6"</span>)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">=</span> <span class="fu">rbind</span>(table3, <span class="fu">cbind</span>(<span class="fu">cbind</span>(unstandardizedLoadings<span class="sc">$</span>lambda[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">2</span>]), <span class="fu">cbind</span>(unstandardizedSE<span class="sc">$</span>lambda[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">2</span>]), <span class="fu">cbind</span>(standardizedLoadings<span class="sc">$</span>lambda[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">2</span>])))</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table3)[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Item 1"</span>, <span class="st">"Item 3"</span>, <span class="st">"Item 5"</span>)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">=</span> <span class="fu">rbind</span>(table3, <span class="fu">c</span>(unstandardizedLoadings<span class="sc">$</span>psi[<span class="dv">2</span>,<span class="dv">1</span>], unstandardizedSE<span class="sc">$</span>psi[<span class="dv">2</span>,<span class="dv">1</span>], standardizedLoadings<span class="sc">$</span>psi[<span class="dv">2</span>,<span class="dv">1</span>]))</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table3)[<span class="dv">7</span>] <span class="ot">=</span> <span class="st">"Factor Covariance"</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>interceptsOrder <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">3</span>)</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">=</span> <span class="fu">rbind</span>(table3, <span class="fu">cbind</span>(<span class="fu">cbind</span>(unstandardizedLoadings<span class="sc">$</span>nu[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span>][interceptsOrder]), <span class="fu">cbind</span>(unstandardizedSE<span class="sc">$</span>nu[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span>][interceptsOrder]),</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">cbind</span>(standardizedLoadings<span class="sc">$</span>nu[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span>][interceptsOrder])))</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table3)[<span class="dv">8</span><span class="sc">:</span><span class="dv">13</span>] <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"Item"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">=</span> <span class="fu">rbind</span>(table3, <span class="fu">cbind</span>(<span class="fu">cbind</span>(<span class="fu">diag</span>(unstandardizedLoadings<span class="sc">$</span>theta)[interceptsOrder]), <span class="fu">cbind</span>(<span class="fu">diag</span>(unstandardizedSE<span class="sc">$</span>theta)[interceptsOrder]),</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">cbind</span>(<span class="fu">diag</span>(standardizedLoadings<span class="sc">$</span>theta)[interceptsOrder])))</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table3)[<span class="dv">14</span><span class="sc">:</span><span class="dv">19</span>] <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"Item"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table3, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="st">"striped"</span>) <span class="sc">%&gt;%</span> <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Unstandardized"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Standardized"</span> <span class="ot">=</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="fu">group_rows</span>(<span class="st">"Forgiveness Factor Loadings"</span>, <span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">group_rows</span>(<span class="st">"Not Unforgiveness Factor Loadings"</span>, <span class="dv">4</span>,<span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_rows</span>(<span class="st">"Factor Covariance"</span>, <span class="dv">7</span>,<span class="dv">7</span>) <span class="sc">%&gt;%</span> <span class="fu">group_rows</span>(<span class="st">"Item Intercepts"</span>, <span class="dv">8</span>,<span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">group_rows</span>(<span class="st">"Item Unique Variances"</span>, <span class="dv">14</span>, <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Unstandardized
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standardized
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>Forgiveness Factor Loadings</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 2</td>
<td style="text-align: right;">1.107</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.781</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 4</td>
<td style="text-align: right;">1.057</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.752</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 6</td>
<td style="text-align: right;">0.893</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.591</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>Not Unforgiveness Factor Loadings</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 1</td>
<td style="text-align: right;">1.372</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.766</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 3</td>
<td style="text-align: right;">1.391</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.860</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 5</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.579</td>
</tr>
<tr class="odd" data-grouplength="1">
<td colspan="4" style="border-bottom: 1px solid"><strong>Factor Covariance</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Factor Covariance</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.611</td>
</tr>
<tr class="odd" data-grouplength="6">
<td colspan="4" style="border-bottom: 1px solid"><strong>Item Intercepts</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 1</td>
<td style="text-align: right;">4.443</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">2.480</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 2</td>
<td style="text-align: right;">5.287</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">3.731</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 3</td>
<td style="text-align: right;">4.778</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">2.954</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 4</td>
<td style="text-align: right;">5.314</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">3.780</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 5</td>
<td style="text-align: right;">4.761</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">2.759</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 6</td>
<td style="text-align: right;">5.263</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">3.485</td>
</tr>
<tr class="even" data-grouplength="6">
<td colspan="4" style="border-bottom: 1px solid"><strong>Item Unique Variances</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 1</td>
<td style="text-align: right;">1.326</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">0.413</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 2</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.390</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 3</td>
<td style="text-align: right;">0.682</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">0.261</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 4</td>
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.435</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 5</td>
<td style="text-align: right;">1.980</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.665</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Item 6</td>
<td style="text-align: right;">1.484</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.651</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="figures" class="level3">
<h3 class="anchored" data-anchor-id="figures">Figures</h3>
<section id="figure-1-factor-score-distributions" class="level4">
<h4 class="anchored" data-anchor-id="figure-1-factor-score-distributions">Figure 1: Factor Score Distributions</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram overlaid with kernel density curve</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fscores<span class="sc">$</span>scores, <span class="fu">aes</span>(<span class="at">x=</span>SitP)) <span class="sc">+</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),      <span class="co"># Histogram with density instead of count on y-axis</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth=</span>.<span class="dv">5</span>,</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Positive Situation Forgiveness Factor Score"</span>) <span class="sc">+</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">fill=</span><span class="st">"#FF6666"</span>)    <span class="co"># Overlay with transparent density plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram overlaid with kernel density curve</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fscores<span class="sc">$</span>scores, <span class="fu">aes</span>(<span class="at">x=</span>SitN)) <span class="sc">+</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),      <span class="co"># Histogram with density instead of count on y-axis</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth=</span>.<span class="dv">5</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Negative Situation Forgiveness Factor Score"</span>) <span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">fill=</span><span class="st">"#FF6666"</span>)    <span class="co"># Overlay with transparent density plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-2-expected-item-response-plots" class="level4">
<h4 class="anchored" data-anchor-id="figure-2-expected-item-response-plots">Figure 2 : Expected Item Response Plots</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cfaPlots</span>(<span class="at">lavObject =</span> model04Estimates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EPSY906_Example04_CFA_simulated_lavaan_files/figure-html/figure2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>